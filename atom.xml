<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Fy.L 的个人博客</title>
  
  <subtitle>自学尚未成才的码农0=0</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.lifayu.com/"/>
  <updated>2019-01-10T11:13:02.274Z</updated>
  <id>http://www.lifayu.com/</id>
  
  <author>
    <name>Fy.L</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ArcGIS Runtime Android查看Shapefile几何类型</title>
    <link href="http://www.lifayu.com/2019/01/11/ArcGIS-Runtime-Android%E6%9F%A5%E7%9C%8BShapefile%E5%87%A0%E4%BD%95%E7%B1%BB%E5%9E%8B/"/>
    <id>http://www.lifayu.com/2019/01/11/ArcGIS-Runtime-Android查看Shapefile几何类型/</id>
    <published>2019-01-10T19:12:40.000Z</published>
    <updated>2019-01-10T11:13:02.274Z</updated>
    
    <content type="html"><![CDATA[<p>标签 ： </p><hr><p>【参考链接】<br><a href="http://zhihu.esrichina.com.cn/question/19622" target="_blank" rel="noopener">http://zhihu.esrichina.com.cn/question/19622</a></p><p>【问题描述】</p><blockquote><p>调用ShapefileFeatureTable.getGeometryType返回几何类型是Unknown。</p></blockquote><p>【解决办法】：<br>这一问题和ArcGIS Runtime SDK 100系列中的Loadable异步加载机制有关系，需要在加载完成的回调函数中进行判断<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">shapefileFeatureTable = <span class="keyword">new</span> ShapefileFeatureTable(Environment.getExternalStorageDirectory().getAbsolutePath() + /ArcGIS/shapefile/center.shp);</span><br><span class="line">shapefileFeatureTable.loadAsync();</span><br><span class="line">shapefileFeatureTable.addDoneLoadingListener(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(shapefileFeatureTable.getGeometryType());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;标签 ： &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;【参考链接】&lt;br&gt;&lt;a href=&quot;http://zhihu.esrichina.com.cn/question/19622&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://zhihu.esrichina.
      
    
    </summary>
    
      <category term="ArcGIS" scheme="http://www.lifayu.com/categories/ArcGIS/"/>
    
      <category term="ArcGIS Runtime for Android" scheme="http://www.lifayu.com/categories/ArcGIS/ArcGIS-Runtime-for-Android/"/>
    
    
      <category term="ArcGIS" scheme="http://www.lifayu.com/tags/ArcGIS/"/>
    
      <category term="ArcGIS Runtime" scheme="http://www.lifayu.com/tags/ArcGIS-Runtime/"/>
    
  </entry>
  
  <entry>
    <title>【转载】ArcGIS Runtime SDK for Android开发笔记》——离在线一体化技术：离线矢量数据编辑</title>
    <link href="http://www.lifayu.com/2019/01/11/%E3%80%90%E8%BD%AC%E8%BD%BD%E3%80%91ArcGIS-Runtime-SDK-for-Android%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0%E3%80%8B%E2%80%94%E2%80%94%E7%A6%BB%E5%9C%A8%E7%BA%BF%E4%B8%80%E4%BD%93%E5%8C%96%E6%8A%80%E6%9C%AF-%E7%A6%BB%E7%BA%BF%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E7%BC%96%E8%BE%91/"/>
    <id>http://www.lifayu.com/2019/01/11/【转载】ArcGIS-Runtime-SDK-for-Android开发笔记》——离在线一体化技术-离线矢量数据编辑/</id>
    <published>2019-01-10T19:11:33.000Z</published>
    <updated>2019-01-10T11:12:24.447Z</updated>
    
    <content type="html"><![CDATA[<p>【原文链接：<a href="https://www.cnblogs.com/gis-luq/p/5858055.html】" target="_blank" rel="noopener">https://www.cnblogs.com/gis-luq/p/5858055.html】</a></p><hr><h2 id="1、前言"><a href="#1、前言" class="headerlink" title="1、前言"></a>1、前言</h2><p>在上一篇我们已经实现了<a href="http://www.cnblogs.com/gis-luq/p/5858048.html" target="_blank" rel="noopener">离线地理数据库的下载</a>，这一篇我们着重介绍离线数据库的加载与编辑。</p><p>由于ArcGIS Runtime SDK for Android 10.2.X版本并没提供要素绘制功能，所以本篇中的要素绘制部分基于之前开源的<a href="http://www.cnblogs.com/gis-luq/p/5857661.html" target="_blank" rel="noopener">Drawtools3.0工具</a>实现。</p><p>本DEMO主要实现了：离线地理数据库加载、要素样式模板加载，要素新建、要素选择并开启编辑状态、要素删除等操作。由于内容较多涉及编辑部分仅详细介绍对Geodatabase的要素添加、要素删除、要素更新部分，其余请自行查阅源代码。</p><p><img src="http://upload-images.jianshu.io/upload_images/3832962-acfb21b094c25bd7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="离线地理数据库编辑"></p><p>转载请注明出处：<a href="http://www.cnblogs.com/gis-luq/p/5858055.html" title="view: 《ArcGIS Runtime SDK for Android开发笔记》——离在线一体化技术：离线矢量数据编辑" target="_blank" rel="noopener">http://www.cnblogs.com/gis-luq/p/5858055.html</a> </p><h2 id="2、离线要素编辑实现过程"><a href="#2、离线要素编辑实现过程" class="headerlink" title="2、离线要素编辑实现过程"></a>2、离线要素编辑实现过程</h2><h3 id="2-1、加载本地离线要素"><a href="#2-1、加载本地离线要素" class="headerlink" title="2.1、加载本地离线要素"></a>2.1、加载本地离线要素</h3><p>ArcGIS Runtime SDK for Android中提供了具体的Geodatabase类和FeatureLayer图层来加载.geodatabase文件，常用的类包括Geodatabase、GeodatabaseFeatureTable、GeodatabaseFeature、GeodatabaseFeatureServiceTable等，分别用来打开geodatabase数据文件、获取要素图层、获取图层中的具体要素，以及获取在线的要素服务。具体来讲，加载.geodatabase文件的步骤有如下几步：</p><ol><li>实例化一个Geodatabase对象，这个类有两个构造函数，都需要指定本地数据库的存储路径；</li><li>创建一个GeodatabaseFeatureTable对象实例，用来获取需要的图层；</li><li>创建一个FeatureLayer来存储获取的图层，并将获取的图层加载到地图中；</li><li>调用dispose()方式释放资源。<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** * 读取Geodatabase中离线地图信息</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> geodatabsePath 离线Geodatabase文件路径 */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addFeatureLayer</span><span class="params">(String geodatabsePath)</span> </span>&#123;</span><br><span class="line">    Geodatabase localGdb = <span class="keyword">null</span>; </span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        localGdb = <span class="keyword">new</span> Geodatabase(geodatabsePath);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    layerList = <span class="keyword">new</span> ArrayList&lt;&gt;(); <span class="comment">// 添加FeatureLayer到MapView中</span></span><br><span class="line">    <span class="keyword">if</span> (localGdb != <span class="keyword">null</span>) &#123; </span><br><span class="line">        <span class="keyword">for</span> (GeodatabaseFeatureTable gdbFeatureTable : localGdb.getGeodatabaseTables()) &#123; </span><br><span class="line">            <span class="keyword">if</span> (gdbFeatureTable.hasGeometry())&#123;</span><br><span class="line">                FeatureLayer layer = <span class="keyword">new</span> FeatureLayer(gdbFeatureTable);</span><br><span class="line">                mMapView.addLayer(layer);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>2.2、加载本地要素样式模板</p><p><img src="http://upload-images.jianshu.io/upload_images/3832962-af5597d7f66d57c6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="点"></p><p>  <img src="http://upload-images.jianshu.io/upload_images/3832962-d086b0b7d53205bf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="线"></p><p>  <img src="http://upload-images.jianshu.io/upload_images/3832962-6ab13d21bc562981.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="面"></p><p>绘制要素时往往会需要知道待绘制要素的图层名称以及要素的符号化样式，这里我们以geodatabse中的FeatureLayer为例演示要素样式模板获取流程。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** * 添加要素绘制样式模板</span></span><br><span class="line"><span class="comment"> * 获取图层要素模板并添加到featureTempleteView</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> layer */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addFeatureTemplate</span><span class="params">(FeatureLayer layer)</span> </span>&#123;</span><br><span class="line">    List&lt;FeatureTemplate&gt; featureTemp = ((GeodatabaseFeatureTable) layer.getFeatureTable()).getFeatureTemplates(); </span><br><span class="line">    <span class="keyword">for</span> (FeatureTemplate featureTemplate : featureTemp) &#123;</span><br><span class="line">        GeodatabaseFeature g = <span class="keyword">null</span>; </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            g = ((GeodatabaseFeatureTable) layer.getFeatureTable()).createFeatureWithTemplate(featureTemplate, <span class="keyword">null</span>);</span><br><span class="line">            Renderer renderer = layer.getRenderer();</span><br><span class="line">            Symbol symbol = renderer.getSymbol(g); <span class="keyword">float</span> scale = context.getResources().getDisplayMetrics().density; <span class="keyword">int</span> widthInPixels = (<span class="keyword">int</span>) (<span class="number">35</span> * scale + <span class="number">0.5f</span>);</span><br><span class="line">            Bitmap bitmap = SymbolHelper.getLegendImage(symbol, widthInPixels, widthInPixels); <span class="comment">//将要素样式模板赋值给imgButton</span></span><br><span class="line">            ImageButton imageButton = <span class="keyword">new</span> ImageButton(context);</span><br><span class="line">            imageButton.setImageBitmap(bitmap);</span><br><span class="line">            imageButton.setTag(layer);<span class="comment">//保存当前待编辑图层</span></span><br><span class="line">            ((LinearLayout)featureTempleteView).addView(imageButton);<span class="comment">//添加到要素样式模板列表</span></span><br><span class="line">            imageButton.setOnClickListener(<span class="keyword">new</span> ImageButtonOnClickListener());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (TableException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">"Error："</span> + e.getLocalizedMessage(), Toast.LENGTH_SHORT).show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-2-编辑本地离线要素"><a href="#2-2-编辑本地离线要素" class="headerlink" title="2.2 编辑本地离线要素"></a>2.2 编辑本地离线要素</h3><p>要素编辑最核心的是FeatureTable中的增删改方法，通过这些方法可以实现本地数据库中要素编辑操作。</p><p>FeatureTable中的常用方法如下：</p><ul><li><a href="https://developers.arcgis.com/android/api-reference/reference/com/esri/core/table/FeatureTable.html#addFeature(com.esri.core.map.Feature" target="_blank" rel="noopener">addFeature</a>):增加本地要素</li><li><a href="https://developers.arcgis.com/android/api-reference/reference/com/esri/core/table/FeatureTable.html#addFeatures(java.util.List%3Ccom.esri.core.map.Feature%3E" target="_blank" rel="noopener">addFeatures</a>):一次添加多个要素到离线数据库中</li><li><a href="https://developers.arcgis.com/android/api-reference/reference/com/esri/core/table/FeatureTable.html#deleteFeature(long" target="_blank" rel="noopener">deleteFeature</a>):删除本地要素</li><li><a href="https://developers.arcgis.com/android/api-reference/reference/com/esri/core/table/FeatureTable.html#deleteFeatures(long[]" target="_blank" rel="noopener">deleteFeatures</a>):删除多个本地要素</li><li><a href="https://developers.arcgis.com/android/api-reference/reference/com/esri/core/table/FeatureTable.html#queryFeatures(com.esri.core.tasks.query.QueryParameters,%20com.esri.core.map.CallbackListener%3Ccom.esri.core.map.FeatureResult%3E" target="_blank" rel="noopener">queryFeatures</a>):查询本地要素</li><li><a href="https://developers.arcgis.com/android/api-reference/reference/com/esri/core/table/FeatureTable.html#updateFeature(long,%20com.esri.core.map.Feature" target="_blank" rel="noopener">updateFeature</a>):更新要素到本地</li><li><a href="https://developers.arcgis.com/android/api-reference/reference/com/esri/core/table/FeatureTable.html#updateFeatures(long[],%20java.util.List%3Ccom.esri.core.map.Feature%3E" target="_blank" rel="noopener">updateFeatures</a>):更新多个要素到本地</li></ul><h4 id="2-2-1-要素添加"><a href="#2-2-1-要素添加" class="headerlink" title="2.2.1 要素添加"></a>2.2.1 要素添加</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">private FeatureLayer selectFeatureLayer;//当前选中图层 </span><br><span class="line">private Graphic selectGraphic = null;//待添加要素（零时图层中获取）</span><br><span class="line">    GeodatabaseFeatureTable geodatabaseFeatureTable = (GeodatabaseFeatureTable)selectFeatureLayer.getFeatureTable();</span><br><span class="line">    GeodatabaseFeature gdbFeature = new GeodatabaseFeature(null, selectGraphic.getGeometry(), geodatabaseFeatureTable); long fid = geodatabaseFeatureTable.addFeature(gdbFeature);// 添加要素</span><br><span class="line">    Log.d(TAG,&quot;要素添加成功，Feature ID：&quot;+fid);</span><br><span class="line">&#125; catch (TableException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-2-2-要素删除"><a href="#2-2-2-要素删除" class="headerlink" title="2.2.2 要素删除"></a>2.2.2 要素删除</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">private FeatureLayer selectFeatureLayer;//当前选中图层</span><br><span class="line">private Feature selectFeature = null;//当前选中要素</span><br><span class="line">GeodatabaseFeatureTable geodatabaseFeatureTable = (GeodatabaseFeatureTable)selectFeatureLayer.getFeatureTable(); </span><br><span class="line">try&#123; </span><br><span class="line">    if (selectFeature!=null)&#123;</span><br><span class="line">        eodatabaseFeatureTable.deleteFeature(selectFeature.getId());//删除要素</span><br><span class="line">   &#125;</span><br><span class="line">&#125; catch (TableException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-2-3-要素矢量信息更新"><a href="#2-2-3-要素矢量信息更新" class="headerlink" title="2.2.3 要素矢量信息更新"></a>2.2.3 要素矢量信息更新</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">private FeatureLayer selectFeatureLayer;//当前选中图层 private Feature selectFeature = null;//当前选中要素</span><br><span class="line">private Graphic selectGraphic = null;//待更新要素（零时图层中获取）</span><br><span class="line">try &#123;</span><br><span class="line">    GeodatabaseFeatureTable geodatabaseFeatureTable = (GeodatabaseFeatureTable)selectFeatureLayer.getFeatureTable();</span><br><span class="line">    geodatabaseFeatureTable.updateFeature(selectFeature.getId(),selectGraphic.getGeometry());//更新要素</span><br><span class="line">    Log.d(TAG,&quot;要素更新成功&quot;);</span><br><span class="line">&#125; catch (TableException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="扩展说明：如何选中要素，以及如何处理具有压盖关系的要素选择问题？"><a href="#扩展说明：如何选中要素，以及如何处理具有压盖关系的要素选择问题？" class="headerlink" title="扩展说明：如何选中要素，以及如何处理具有压盖关系的要素选择问题？"></a>扩展说明：如何选中要素，以及如何处理具有压盖关系的要素选择问题？</h4><p>针对这两个问题我们一并处理，首先扩展MapOnTouchListener类，实现长按出现放大镜，并选中要素。选中要素时我们采用遍历当前所有图层的方式，找出每个图层中第一个被选中的要素，然后弹窗提示供用户选择。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//全局定义信息</span><br><span class="line">private List&lt;FeatureLayer&gt; layerList;//矢量图层列表</span><br><span class="line">private GraphicsLayer graphicsLayer = null;//零时图层</span><br><span class="line">private FeatureLayer selectFeatureLayer;//当前选中图层</span><br><span class="line">private Graphic selectGraphic = null;//当前选中要素（零时图层）</span><br><span class="line">private Feature selectFeature = null;//当前选中要素</span><br></pre></td></tr></table></figure><p>要素选中扩展事件。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">/** * 地图窗口默认Touch事件</span><br><span class="line"> * 支持长按放大镜选种要素 */</span><br><span class="line">public class MapSelectFeatureOnTouchListener extends MapOnTouchListener&#123; </span><br><span class="line"></span><br><span class="line">    public MapSelectFeatureOnTouchListener(Context context, MapView view) &#123; </span><br><span class="line">        super(context, view);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override public boolean onLongPressUp(MotionEvent point) &#123;</span><br><span class="line">        handleTap(point); //长按放大镜选择事件</span><br><span class="line">        super.onLongPressUp(point); return true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override public boolean onSingleTap(final MotionEvent e) &#123; //单击响应事件</span><br><span class="line">        return true;</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    /** * 获取当前选中要素</span><br><span class="line">     * @param point */</span><br><span class="line">    private void handleTap(MotionEvent point) &#123;</span><br><span class="line">        MotionEvent screePoint = point; //选中图层信息</span><br><span class="line">        final List&lt;SelectFeatureInfo&gt; selectFeatureInfoList = new ArrayList&lt;&gt;(); //记录当前选中要素信息，涉及多个图层情况</span><br><span class="line">        for (int i=0;i&lt;layerList.size();i++)&#123;</span><br><span class="line">            FeatureLayer featureLayer = layerList.get(i);</span><br><span class="line">            featureLayer.setSelectionColor(Color.YELLOW);</span><br><span class="line">            featureLayer.setSelectionColorWidth(10); long[] selids = featureLayer.getFeatureIDs(screePoint.getX(), screePoint.getY(), 1); if (selids.length &gt;= 1) &#123;</span><br><span class="line">                SelectFeatureInfo selectFeatureInfo = new SelectFeatureInfo();</span><br><span class="line">                selectFeatureInfo.featureLayer = featureLayer;</span><br><span class="line">                selectFeatureInfo.selectFeatureID = selids[0];</span><br><span class="line">                selectFeatureInfoList.add(selectFeatureInfo);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; </span><br><span class="line">        //根据待选图层确定是否弹窗选择</span><br><span class="line">        if(selectFeatureInfoList.size()&gt;1)&#123; //当前选中要素大于1个图层</span><br><span class="line">            AlertDialog.Builder builder = new AlertDialog.Builder(MainActivity.this);</span><br><span class="line">            builder.setTitle(&quot;请确认选择哪个图层要素？&quot;); //指定下拉列表的显示数据</span><br><span class="line">            final String[] layerNamelist = getSelectFeatureInfoListName(selectFeatureInfoList); //设置一个下拉的列表选择项</span><br><span class="line">            builder.setItems(layerNamelist, new DialogInterface.OnClickListener()</span><br><span class="line">            &#123;</span><br><span class="line">                @Override public void onClick(DialogInterface dialog, int which)</span><br><span class="line">                &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.this, &quot;选择的图层为：&quot; + layerNamelist[which], Toast.LENGTH_SHORT).show();</span><br><span class="line">                    SelectFeatureInfo selectFeaInfo = getFeatureLayerbyName(selectFeatureInfoList,layerNamelist[which]);</span><br><span class="line">                    setSelectFeature(selectFeaInfo);//根据选中图层信息选中当前要素</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            builder.show();</span><br><span class="line">        &#125;else if(selectFeatureInfoList.size()==1) &#123;</span><br><span class="line">            SelectFeatureInfo selectFeaInfo = selectFeatureInfoList.get(0);</span><br><span class="line">            setSelectFeature(selectFeaInfo);//根据选中图层信息选中当前要素</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    /** * 设置选中图层的要素选中信息</span><br><span class="line">     * @param selectFeaInfo 待选图层信息 */</span><br><span class="line">    private void setSelectFeature(SelectFeatureInfo selectFeaInfo) &#123;</span><br><span class="line">        clearFeatureSelection();//设置选中状态前，清空已选择要素</span><br><span class="line">        selectFeaInfo.featureLayer.selectFeature(selectFeaInfo.selectFeatureID);</span><br><span class="line">        selectFeatureLayer = selectFeaInfo.featureLayer;</span><br><span class="line">        selectFeature = selectFeatureLayer.getFeature(selectFeaInfo.selectFeatureID); switch (selectFeature.getGeometry().getType())&#123; </span><br><span class="line">            case POINT: case MULTIPOINT:</span><br><span class="line">                selectGraphic = new Graphic(selectFeature.getGeometry(), DrawSymbol.markerSymbol, null); </span><br><span class="line">                break; </span><br><span class="line">            case LINE: case POLYLINE:</span><br><span class="line">                selectGraphic = new Graphic(selectFeature.getGeometry(), DrawSymbol.mLineSymbol,null); </span><br><span class="line">                break; </span><br><span class="line">            case ENVELOPE: </span><br><span class="line">            case POLYGON:</span><br><span class="line">                selectGraphic = new Graphic(selectFeature.getGeometry(), DrawSymbol.mFillSymbol, null); </span><br><span class="line">                break; </span><br><span class="line">            default: </span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    /** * 通过图层名称获取要素</span><br><span class="line">     * @param name 图层名称</span><br><span class="line">     * @return 选中图层信息 */</span><br><span class="line">    private SelectFeatureInfo getFeatureLayerbyName(List&lt;SelectFeatureInfo&gt; selectFeatureInfoList,String name)&#123;</span><br><span class="line">        SelectFeatureInfo selectinfo= null; </span><br><span class="line">        for (int i=0;i&lt;selectFeatureInfoList.size();i++)&#123;</span><br><span class="line">            FeatureLayer tmplayer = selectFeatureInfoList.get(i).featureLayer; </span><br><span class="line">            if (tmplayer.getName().equals(name))&#123;</span><br><span class="line">               selectinfo = selectFeatureInfoList.get(i);//选中图层信息</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; </span><br><span class="line">        return selectinfo;</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    /** * 获取待选择要素列表名称</span><br><span class="line">     * @param selectFeatureInfoList 待选中要素列表信息</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    private String[] getSelectFeatureInfoListName(List&lt;SelectFeatureInfo&gt; selectFeatureInfoList) &#123;</span><br><span class="line">        List&lt;String&gt; lsname = new ArrayList&lt;&gt;(); for (int i=0;i&lt;selectFeatureInfoList.size();i++)&#123;</span><br><span class="line">            lsname.add(selectFeatureInfoList.get(i).featureLayer.getName());</span><br><span class="line">        &#125; return lsname.toArray(new String[lsname.size()]);</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    /** * 记录当前选中要素信息 */</span><br><span class="line">    public class SelectFeatureInfo&#123; public FeatureLayer featureLayer ;//当前选中要素</span><br><span class="line">        public long selectFeatureID ;//当前选中要素ID</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3、完整代码"><a href="#3、完整代码" class="headerlink" title="3、完整代码"></a>3、完整代码</h2><p>完整代码不定期更新，具体请查阅DEMOt源代码，托管地址：<a href="http://git.oschina.net/gis-luq/RuntimeOfflineEdit" target="_blank" rel="noopener">http://git.oschina.net/gis-luq/RuntimeOfflineEdit</a></p><h2 id="4、运行后编辑结果（以备同步测试使用）"><a href="#4、运行后编辑结果（以备同步测试使用）" class="headerlink" title="4、运行后编辑结果（以备同步测试使用）"></a>4、运行后编辑结果（以备同步测试使用）</h2><p><img src="http://upload-images.jianshu.io/upload_images/3832962-2b1a497576e1e87e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="编辑结果"></p><p>转载请注明出处：<a href="http://www.cnblogs.com/gis-luq/p/5858055.html" title="view: 《ArcGIS Runtime SDK for Android开发笔记》——离在线一体化技术：离线矢量数据编辑" target="_blank" rel="noopener">http://www.cnblogs.com/gis-luq/p/5858055.html</a></p><blockquote><p><strong>文章若无特殊说明均为原创，原创作品，允许转载，转载时请务必以超链接形式标明文章出处、作者信息和本声明。<br>博客：<a href="http://www.cnblogs.com/gis-luq" target="_blank" rel="noopener">http:</a><a href="http://www.cnblogs.com/gis-luq" target="_blank" rel="noopener">//www.cnblogs.com/gis-luq​</a> 作者：gis-luq 邮箱：<a href="mailto:luqiang.gis@foxmail.com" target="_blank" rel="noopener">luqiang.gis@foxmail.com</a></strong></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;【原文链接：&lt;a href=&quot;https://www.cnblogs.com/gis-luq/p/5858055.html】&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.cnblogs.com/gis-luq/p/5858055.
      
    
    </summary>
    
      <category term="ArcGIS" scheme="http://www.lifayu.com/categories/ArcGIS/"/>
    
      <category term="ArcGIS Runtime for Android" scheme="http://www.lifayu.com/categories/ArcGIS/ArcGIS-Runtime-for-Android/"/>
    
    
      <category term="ArcGIS" scheme="http://www.lifayu.com/tags/ArcGIS/"/>
    
      <category term="ArcGIS Runtime" scheme="http://www.lifayu.com/tags/ArcGIS-Runtime/"/>
    
  </entry>
  
  <entry>
    <title>《ArcGIS Runtime SDK for Android开发笔记》——离在线一体化技术：离线矢量数据下载</title>
    <link href="http://www.lifayu.com/2019/01/11/%E3%80%8AArcGIS-Runtime-SDK-for-Android%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0%E3%80%8B%E2%80%94%E2%80%94%E7%A6%BB%E5%9C%A8%E7%BA%BF%E4%B8%80%E4%BD%93%E5%8C%96%E6%8A%80%E6%9C%AF-%E7%A6%BB%E7%BA%BF%E7%9F%A2%E9%87%8F%E6%95%B0%E6%8D%AE%E4%B8%8B%E8%BD%BD/"/>
    <id>http://www.lifayu.com/2019/01/11/《ArcGIS-Runtime-SDK-for-Android开发笔记》——离在线一体化技术-离线矢量数据下载/</id>
    <published>2019-01-10T19:10:27.000Z</published>
    <updated>2019-01-10T11:12:06.135Z</updated>
    
    <content type="html"><![CDATA[<p>【<strong>原文链接：<a href="http://www.cnblogs.com/gis-luq/p/5858048.html" target="_blank" rel="noopener">http://www.cnblogs.com/gis-luq/p/5858048.html</a> </strong>】</p><hr><h2 id="1、前言"><a href="#1、前言" class="headerlink" title="1、前言"></a>1、前言</h2><h3 id="1-1、环境准备："><a href="#1-1、环境准备：" class="headerlink" title="1.1、环境准备："></a>1.1、环境准备：</h3><ul><li>ArcGIS for Desktop 10.4.1（10.2.1以上版本即可）</li><li>ArcGIS for Server 10.4.1 （10.2.1以上版本即可）</li><li>PostgreSQL、Microsoft SQL Server、或 Oracle <a href="https://server.arcgis.com/zh-cn/server/latest/get-started/windows/tutorial-set-up-feature-service-data-for-offline-use.htm#GUID-1707450E-02E5-4F37-BE66-B561849C10A3" target="_blank" rel="noopener">设置企业级地理数据库</a>。</li></ul><h3 id="1-2、发布具有同步能力的FeatureService服务"><a href="#1-2、发布具有同步能力的FeatureService服务" class="headerlink" title="1.2、发布具有同步能力的FeatureService服务"></a>1.2、发布具有同步能力的FeatureService服务</h3><p>　　过程参考 <a href="http://www.cnblogs.com/gis-luq/p/5857188.html" target="_blank" rel="noopener">数据制作篇：发布具有同步能力的FeatureService服务</a> 一文。</p><p><img src="http://upload-images.jianshu.io/upload_images/3832962-5c05a63330036344.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p><p>转载请注明出处：<a href="http://www.cnblogs.com/gis-luq/p/5858048.html" title="view: 《ArcGIS Runtime SDK for Android开发笔记》——离在线一体化技术：离线矢量数据下载" target="_blank" rel="noopener">http://www.cnblogs.com/gis-luq/p/5858048.html</a> </p><h2 id="2、demo实现过程"><a href="#2、demo实现过程" class="headerlink" title="2、demo实现过程"></a>2、demo实现过程</h2><p>ArcGIS Runtime SDK 配置实现过程略：具体请参考：</p><p><a href="http://www.cnblogs.com/gis-luq/p/4760370.html" target="_blank" rel="noopener">基于Android Studio构建ArcGIS Android开发环境</a> </p><p><a href="http://www.cnblogs.com/gis-luq/p/4760377.html" target="_blank" rel="noopener">基于Android Studio构建ArcGIS Android开发环境（离线部署）</a></p><h3 id="2-1、Demo-UI实现"><a href="#2-1、Demo-UI实现" class="headerlink" title="2.1、Demo UI实现"></a>2.1、Demo UI实现</h3><p>activity_main.xml</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; </span><br><span class="line">xmlns:tools=&quot;http://schemas.android.com/tools&quot; </span><br><span class="line">android:layout_width=&quot;match_parent&quot; </span><br><span class="line">android:layout_height=&quot;match_parent&quot; </span><br><span class="line">tools:context=&quot;com.example.downgdb.MainActivity&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- MapView --&gt;</span><br><span class="line">    &lt;com.esri.android.map.MapView </span><br><span class="line">    android:id=&quot;@+id/map&quot; </span><br><span class="line">    android:layout_width=&quot;fill_parent&quot; </span><br><span class="line">    android:layout_height=&quot;fill_parent&quot; </span><br><span class="line">    mapoptions.MapType=&quot;Topo&quot; </span><br><span class="line">    mapoptions.ZoomLevel=&quot;5&quot; </span><br><span class="line">    mapoptions.center=&quot;28.671298, 104.066404&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;LinearLayout </span><br><span class="line">    android:orientation=&quot;horizontal&quot; </span><br><span class="line">    android:layout_width=&quot;match_parent&quot; </span><br><span class="line">    android:layout_height=&quot;wrap_content&quot; </span><br><span class="line">    android:padding=&quot;10dp&quot; </span><br><span class="line">    android:id=&quot;@+id/linearLayout&quot; </span><br><span class="line">    android:background=&quot;@color/primary_material_light&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;EditText </span><br><span class="line">        android:layout_width=&quot;match_parent&quot; </span><br><span class="line">        android:layout_height=&quot;match_parent&quot; </span><br><span class="line">        android:id=&quot;@+id/editTextGDBUrl&quot; </span><br><span class="line">        android:layout_alignParentTop=&quot;true&quot; </span><br><span class="line">        android:layout_alignParentRight=&quot;true&quot; </span><br><span class="line">        android:layout_alignParentEnd=&quot;true&quot; </span><br><span class="line">        android:layout_weight=&quot;1&quot; </span><br><span class="line">        android:text=&quot;http://192.168.1.212:6080/arcgis/rest/services/testdata/FeatureServer&quot; android:inputType=&quot;textUri&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Button </span><br><span class="line">        android:layout_width=&quot;wrap_content&quot; </span><br><span class="line">        android:layout_height=&quot;wrap_content&quot; </span><br><span class="line">        android:text=&quot;数据下载&quot; </span><br><span class="line">        android:id=&quot;@+id/btnDownGDB&quot; /&gt;</span><br><span class="line">    &lt;/LinearLayout&gt;</span><br><span class="line"></span><br><span class="line">&lt;/RelativeLayout&gt;</span><br></pre></td></tr></table></figure><h3 id="2-2、在Android清单文件AndroidManifest-xml中增加网络及存储访问权限"><a href="#2-2、在Android清单文件AndroidManifest-xml中增加网络及存储访问权限" class="headerlink" title="2.2、在Android清单文件AndroidManifest.xml中增加网络及存储访问权限"></a>2.2、在Android清单文件AndroidManifest.xml中增加网络及存储访问权限</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot; /&gt;</span><br></pre></td></tr></table></figure><h3 id="2-3、实现离线地理数据库下载逻辑"><a href="#2-3、实现离线地理数据库下载逻辑" class="headerlink" title="2.3、实现离线地理数据库下载逻辑"></a>2.3、实现离线地理数据库下载逻辑</h3><h4 id="基本思路："><a href="#基本思路：" class="headerlink" title="基本思路："></a>基本思路：</h4><ol><li>设置.geodatabase文件存储路径</li><li>根据FeatureService服务获取FeatureServiceInfo服务参数信息</li><li>根据FeatureServiceInfo信息创建离线地理数据库文件、</li><li>从已经下载的本地Geodatabase文件中加载矢量数据</li></ol><h4 id="下载数据的核心功能类说明："><a href="#下载数据的核心功能类说明：" class="headerlink" title="下载数据的核心功能类说明："></a>下载数据的核心功能类说明：</h4><ul><li><p>GeodatabaseSyncTask类，实现下载同步功能</p></li><li><p>GenerateGeodatabaseParameters，下载数据时所需的参数对象，该类构造函数一共有7个根据需要选择：</p></li></ul><p><img src="http://upload-images.jianshu.io/upload_images/3832962-4d99d1ec0fc8da1f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p><p>本次示例代码主要用到以下三个参数：</p><ul><li><ul><li>featureServerInfo 服务参数信息</li><li>geodatabaseExtent 地图下载区域范围</li><li>geodatabaseSpatialReference 地图空间参考</li></ul></li><li><p>CallbackListener<geodatabase>，完成GDB数据库下载的回调函数类，在该回调中我们只可以执行一些操作，如示例里在回调中删除了在线的服务图层，加载离线的数据图层到地图上进行显示。通过Geodatabase本地数据库可以获取要素图层列表<a href="http://blog.csdn.net/arcgis_all/article/details/20442663" target="_blank" rel="noopener">List</a>&lt;<a href="http://blog.csdn.net/arcgis_all/article/details/20442663" target="_blank" rel="noopener">GdbFeatureTable</a>&gt;对象，通过newFeatureLayer(gdbFeatureTable)来创建一个离线要素图层进行要素显示。</geodatabase></p></li><li>GeodatabaseStatusCallback，本地数据库回调状态类，在数据下载过程中会有很多状态改变，各种状态改变时都会走这个类的回调函数。</li><li>GeodatabaseTask.generateGeodatabase<em>，</em>通过该方法生成离线数据库和相应的要素表，方法需要传递上面介绍的三个参数和一个数据库存储的路径。</li></ul><h3 id="完整代码示例："><a href="#完整代码示例：" class="headerlink" title="完整代码示例："></a>完整代码示例：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line">package com.example.downgdb; </span><br><span class="line">import android.app.Activity; </span><br><span class="line">import android.app.ProgressDialog; </span><br><span class="line">import android.content.Context; </span><br><span class="line">import android.os.Environment; </span><br><span class="line">import android.support.v7.app.AppCompatActivity; </span><br><span class="line">import android.os.Bundle; </span><br><span class="line">import android.util.Log; </span><br><span class="line">import android.view.View; </span><br><span class="line">import android.view.WindowManager; </span><br><span class="line">import android.widget.Button; </span><br><span class="line">import android.widget.EditText; </span><br><span class="line">import com.esri.android.map.FeatureLayer; </span><br><span class="line">import com.esri.android.map.MapView; </span><br><span class="line">import com.esri.core.ags.FeatureServiceInfo; </span><br><span class="line">import com.esri.core.geodatabase.Geodatabase; </span><br><span class="line">import com.esri.core.geodatabase.GeodatabaseFeatureTable; </span><br><span class="line">import com.esri.core.map.CallbackListener; </span><br><span class="line">import com.esri.core.tasks.geodatabase.GenerateGeodatabaseParameters; </span><br><span class="line">import com.esri.core.tasks.geodatabase.GeodatabaseStatusCallback; </span><br><span class="line">import com.esri.core.tasks.geodatabase.GeodatabaseStatusInfo; </span><br><span class="line">import com.esri.core.tasks.geodatabase.GeodatabaseSyncTask; </span><br><span class="line">import java.io.File; </span><br><span class="line">import java.io.FileNotFoundException; </span><br><span class="line">import java.util.ArrayList; </span><br><span class="line">public class MainActivity extends AppCompatActivity &#123; </span><br><span class="line">protected static final String TAG = &quot;downGDB&quot;; </span><br><span class="line">private Context context; private MapView mMapView;//地图容器</span><br><span class="line"></span><br><span class="line">    private EditText editTextDownGDBUrl;//GDB地址</span><br><span class="line">    private Button btnDownGDB;//下载GDB</span><br><span class="line"></span><br><span class="line">    private static String onlineFeatureLayerUrl;//在线FeatureLayer地址</span><br><span class="line">    private static String localGdbFilePath;//离线GDB地址</span><br><span class="line"></span><br><span class="line">    private GeodatabaseSyncTask gdbSyncTask;//离线地理数据库下载Task</span><br><span class="line">    private ProgressDialog mProgressDialog;//状态框</span><br><span class="line"></span><br><span class="line"> @Override protected void onCreate(Bundle savedInstanceState) &#123; </span><br><span class="line"> super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        context = this; // 默认软键盘不弹出</span><br><span class="line"> getWindow().setSoftInputMode( WindowManager.LayoutParams.SOFT_INPUT_STATE_HIDDEN); </span><br><span class="line"> this.mMapView = (MapView)findViewById(R.id.map); </span><br><span class="line"> this.editTextDownGDBUrl = (EditText)findViewById(R.id.editTextGDBUrl); //获取并设置在线服务地址</span><br><span class="line">        this.onlineFeatureLayerUrl = this.editTextDownGDBUrl.getText().toString();</span><br><span class="line"></span><br><span class="line">        mProgressDialog = new ProgressDialog(context); //设置点击进度对话框外的区域对话框不消失</span><br><span class="line">        mProgressDialog.setCanceledOnTouchOutside(false);</span><br><span class="line">        mProgressDialog.setTitle(&quot;正在创建离线地理数据库副本&quot;); //绑定按钮设置下载事件</span><br><span class="line">        btnDownGDB = (Button)this.findViewById(R.id.btnDownGDB);</span><br><span class="line">        btnDownGDB.setOnClickListener(new View.OnClickListener() &#123;</span><br><span class="line">            @Override public void onClick(View v) &#123;</span><br><span class="line">                downloadData(onlineFeatureLayerUrl);//下载离线数据</span><br><span class="line"> &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    /** </span><br><span class="line">     * Geodatabase文件存储路径 </span><br><span class="line">     */</span><br><span class="line">    static String createGeodatabaseFilePath() &#123; </span><br><span class="line">    return Environment.getExternalStorageDirectory().getAbsolutePath() + File.separator + &quot;/RuntimeOfflineEdit&quot;</span><br><span class="line">                + File.separator + &quot;demo.geodatabase&quot;;</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    /** </span><br><span class="line">     * 下载离线地理数据库</span><br><span class="line">     * @param url FeatureService服务地址</span><br><span class="line">     * 例如：http://192.168.1.212:6080/arcgis/rest/services/testdata/FeatureServer</span><br><span class="line">     * 支持ArcGIS for Server 10.2.1以上版本，必须开启FeatureServer要素同步功能 */</span><br><span class="line">    private void downloadData(String url) &#123;</span><br><span class="line">        Log.i(TAG, &quot;Create GeoDatabase&quot;); // create a dialog to update user on progress</span><br><span class="line"> mProgressDialog.show();</span><br><span class="line"></span><br><span class="line">        gdbSyncTask = new GeodatabaseSyncTask(url, null);</span><br><span class="line">        gdbSyncTask.fetchFeatureServiceInfo(new CallbackListener&lt;FeatureServiceInfo&gt;() &#123;</span><br><span class="line">            @Override public void onError(Throwable arg0) &#123;</span><br><span class="line">                Log.e(TAG, &quot;获取FeatureServiceInfo失败&quot;);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            @Override public void onCallback(FeatureServiceInfo fsInfo) &#123; if (fsInfo.isSyncEnabled()) &#123;</span><br><span class="line">                    createGeodatabase(fsInfo);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    /** </span><br><span class="line">     * 根据FeatureServiceInfo信息创建离线地理数据库文件</span><br><span class="line">     * @param featureServerInfo 服务参数信息 */</span><br><span class="line">    private void createGeodatabase(FeatureServiceInfo featureServerInfo) &#123; // 生成一个geodatabase设置参数</span><br><span class="line">        GenerateGeodatabaseParameters params = new GenerateGeodatabaseParameters(</span><br><span class="line">                featureServerInfo, mMapView.getMaxExtent(), mMapView.getSpatialReference()); // 下载结果回调函数</span><br><span class="line">        CallbackListener&lt;String&gt; gdbResponseCallback = new CallbackListener&lt;String&gt;() &#123;</span><br><span class="line">            @Override public void onError(final Throwable e) &#123;</span><br><span class="line">                Log.e(TAG, &quot;创建geodatabase失败&quot;);</span><br><span class="line">                mProgressDialog.dismiss();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            @Override public void onCallback(String path) &#123;</span><br><span class="line">                Log.i(TAG, &quot;Geodatabase 路径: &quot; + path);</span><br><span class="line">                mProgressDialog.dismiss();</span><br><span class="line">                loadGeodatabase(path);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;; // 下载状态回调函数</span><br><span class="line">        GeodatabaseStatusCallback statusCallback = new GeodatabaseStatusCallback() &#123;</span><br><span class="line">            @Override public void statusUpdated(final GeodatabaseStatusInfo status) &#123; </span><br><span class="line">            final String progress = status.getStatus().toString(); //在UI线程更新下载状态</span><br><span class="line">                ((Activity)context).runOnUiThread(new Runnable()&#123;</span><br><span class="line">                    @Override public void run() &#123;</span><br><span class="line">                        mProgressDialog.setMessage(&quot;数据下载中，请稍后……&quot;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;; //设置离线地理数据库存储路径</span><br><span class="line">        localGdbFilePath = createGeodatabaseFilePath(); //执行下载Geodatabase数据库</span><br><span class="line">        gdbSyncTask.generateGeodatabase(params, localGdbFilePath, false, statusCallback, gdbResponseCallback);</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    /** * 加载离线地理数据库</span><br><span class="line">     * @param path .geodatabse文件路径 </span><br><span class="line">     */</span><br><span class="line">    private void loadGeodatabase(String path) &#123; // 创建一个geodatabase数据库</span><br><span class="line">        Geodatabase localGdb = null; try &#123;</span><br><span class="line">            localGdb = new Geodatabase(path);</span><br><span class="line">        &#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; // 添加FeatureLayer到MapView中</span><br><span class="line">        if (localGdb != null) &#123; </span><br><span class="line">        for (GeodatabaseFeatureTable gdbFeatureTable : localGdb.getGeodatabaseTables()) &#123; </span><br><span class="line">        if (gdbFeatureTable.hasGeometry())&#123;</span><br><span class="line">                    mMapView.addLayer(new FeatureLayer(gdbFeatureTable));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3、Demo运行结果"><a href="#3、Demo运行结果" class="headerlink" title="3、Demo运行结果"></a>3、Demo运行结果</h2><p><img src="http://upload-images.jianshu.io/upload_images/3832962-ba90df41a97b7063.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p><p>源代码托管地址：<a href="http://git.oschina.net/gis-luq/RuntimeOfflineEdit" target="_blank" rel="noopener">http://git.oschina.net/gis-luq/RuntimeOfflineEdit</a></p><h2 id="4、参考资料"><a href="#4、参考资料" class="headerlink" title="4、参考资料"></a>4、参考资料</h2><p><a href="https://developers.arcgis.com/android/api-reference/reference/com/esri/core/tasks/geodatabase/package-summary.html" target="_blank" rel="noopener">https://developers.arcgis.com/android/api-reference/reference/com/esri/core/tasks/geodatabase/package-summary.html</a></p><p><a href="http://blog.csdn.net/arcgis_all/article/details/20442663" target="_blank" rel="noopener">http://blog.csdn.net/arcgis_all/article/details/20442663</a></p><h2 id="相关内容列表"><a href="#相关内容列表" class="headerlink" title="相关内容列表"></a>相关内容列表</h2><p><a href="http://www.cnblogs.com/gis-luq/p/5858043.html" target="_blank" rel="noopener">《ArcGIS Runtime SDK for Android开发笔记》——离在线一体化技术：概述</a></p><p><a href="http://www.cnblogs.com/gis-luq/p/5858048.html" target="_blank" rel="noopener">《ArcGIS Runtime SDK for Android开发笔记》——离在线一体化技术：离线矢量数据下载</a></p><p><a href="http://www.cnblogs.com/gis-luq/p/5858055.html" target="_blank" rel="noopener">《ArcGIS Runtime SDK for Android开发笔记》——离在线一体化技术：离线矢量数据编辑</a></p><p><a href="http://www.cnblogs.com/gis-luq/p/5858062.html" target="_blank" rel="noopener">《ArcGIS Runtime SDK for Android开发笔记》——离在线一体化技术：离线矢量数据同步</a></p><p><a href="http://www.cnblogs.com/gis-luq/p/5857188.html" target="_blank" rel="noopener">《ArcGIS Runtime SDK for Android开发笔记》——数据制作篇：发布具有同步能力的FeatureService服务</a></p><blockquote><p><strong>文章若无特殊说明均为原创，原创作品，允许转载，转载时请务必以超链接形式标明文章出处、作者信息和本声明。<br>博客：<a href="http://www.cnblogs.com/gis-luq" target="_blank" rel="noopener">http:</a><a href="http://www.cnblogs.com/gis-luq" target="_blank" rel="noopener">//www.cnblogs.com/gis-luq​</a> 作者：gis-luq 邮箱：<a href="mailto:luqiang.gis@foxmail.com" target="_blank" rel="noopener">luqiang.gis@foxmail.com</a></strong></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;【&lt;strong&gt;原文链接：&lt;a href=&quot;http://www.cnblogs.com/gis-luq/p/5858048.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://www.cnblogs.com/gis-luq/p/585
      
    
    </summary>
    
      <category term="ArcGIS" scheme="http://www.lifayu.com/categories/ArcGIS/"/>
    
      <category term="ArcGIS Runtime for Android" scheme="http://www.lifayu.com/categories/ArcGIS/ArcGIS-Runtime-for-Android/"/>
    
    
      <category term="ArcGIS" scheme="http://www.lifayu.com/tags/ArcGIS/"/>
    
      <category term="ArcGIS Runtime" scheme="http://www.lifayu.com/tags/ArcGIS-Runtime/"/>
    
  </entry>
  
  <entry>
    <title>在一个项目中同时使用ArcGIS Runtime 和 百度定位SDK</title>
    <link href="http://www.lifayu.com/2019/01/11/%E5%9C%A8%E4%B8%80%E4%B8%AA%E9%A1%B9%E7%9B%AE%E4%B8%AD%E5%90%8C%E6%97%B6%E4%BD%BF%E7%94%A8ArcGIS-Runtime-%E5%92%8C-%E7%99%BE%E5%BA%A6%E5%AE%9A%E4%BD%8DSDK/"/>
    <id>http://www.lifayu.com/2019/01/11/在一个项目中同时使用ArcGIS-Runtime-和-百度定位SDK/</id>
    <published>2019-01-10T19:09:23.000Z</published>
    <updated>2019-01-10T11:10:02.935Z</updated>
    
    <content type="html"><![CDATA[<p>【参考链接：<a href="https://zhidao.baidu.com/question/2267129986490031988.html】" target="_blank" rel="noopener">https://zhidao.baidu.com/question/2267129986490031988.html】</a><br>【本文尚未修改编辑，版本号还是老版本】</p><hr><p>两个SDK都是将其API库封装成so<a href="https://baike.baidu.com/item/%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/100352?fr=aladdin" target="_blank" rel="noopener">动态链接库</a>供上层应用（Java）调用，但两者在具体实现上存在差异，也是这个差异导致将两个SDK集成到一个应用中时容易产生强退的bug，这个问题也曾很大的困扰了我一天，特此分享给大家。</p><p>　　☆ 先看看<a href="https://www.baidu.com/s?wd=%E7%99%BE%E5%BA%A6%E5%9C%B0%E5%9B%BE&amp;tn=44039180_cpr&amp;fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1Y4nynznj63PWIhPvRkPjPb0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnWcvP1DzrHb3PWf4nj01nHb3r0" target="_blank" rel="noopener">百度地图</a> for Android SDK的动态库调用方法：</p><p>　　第一步：在工程里新建libs文件夹，将开发包里的baidumapapi_v2_1_2.jar拷贝到libs根目录下，将libapp_BaiduMapApplib_v2_1_2.so和libvi_voslib.so 拷贝到libs\armeabi目录下（官网demo里已有这三个文件，如果要集成到自己的工程里，就需要自己添加），拷贝完成后的工程目录如下图所示；</p><p>　　注：liblocSDK3.so和locSDK_3.1.jar为百度定位SDK所使用资源，开发者可根据实际需求自行添加。</p><p><img src="https://upload-images.jianshu.io/upload_images/3832962-f13a4b5c31a5018c.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加Jar包"></p><p>　　第二步：在工程属性-&gt;Java Build Path-&gt;Libraries中选择“Add External JARs”，选定baidumapapi_v2_1_2.jar，确定后返回。</p><p>　　通过以上两步操作后，您就可以正常使用<a href="https://www.baidu.com/s?wd=%E7%99%BE%E5%BA%A6%E5%9C%B0%E5%9B%BE&amp;tn=44039180_cpr&amp;fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1Y4nynznj63PWIhPvRkPjPb0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnWcvP1DzrHb3PWf4nj01nHb3r0" target="_blank" rel="noopener">百度地图</a>SDK为您提供的全部功能了。</p><p>　　☆ 再看看ArcGIS for Android SDK的动态库调用方法</p><p>　　其是通过在Eclipse集成开发环境上安装ArcGIS插件来实现的，具体如何安装就不赘述了。当 ArcGIS开发插件安装完成后，在新建工程的选项中就可以看到【ArcGIS Project for Android】和【ArcGIS Samples for Android】的菜单，ArcGIS Android API的开发环境就顺利配置完成了。</p><p>　　然后你可以New –&gt; Project –&gt;ArcGIS Project for Android来新建一个带其<a href="https://www.baidu.com/s?wd=%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93&amp;tn=44039180_cpr&amp;fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1Y4nynznj63PWIhPvRkPjPb0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnWcvP1DzrHb3PWf4nj01nHb3r0" target="_blank" rel="noopener">动态链接库</a>的Android应用程序。例如创建一个test工程，创建成功后如下图所示。本例采用最新的ArcGIS for Android SDK 10.1。</p><p><img src="https://upload-images.jianshu.io/upload_images/3832962-8e4ef5f424e1ed4e.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ArcGIS Runtime 10.1"></p><p>　　小结：以上两种方法，从用户便捷性上来说，ArcGIS 更加“智能”一些，将<a href="https://www.baidu.com/s?wd=%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93&amp;tn=44039180_cpr&amp;fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1Y4nynznj63PWIhPvRkPjPb0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnWcvP1DzrHb3PWf4nj01nHb3r0" target="_blank" rel="noopener">动态链接库</a>添加的工作，直接已经集成到new project里面，对于初学者来说，可以完全忽略这些细节而直接进入关键开发工作；<a href="https://www.baidu.com/s?wd=%E7%99%BE%E5%BA%A6%E5%9C%B0%E5%9B%BE&amp;tn=44039180_cpr&amp;fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1Y4nynznj63PWIhPvRkPjPb0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnWcvP1DzrHb3PWf4nj01nHb3r0" target="_blank" rel="noopener">百度地图</a>的SDK相对来说，更加灵活一些，给用户更大的空间。</p><p>　　但也就是这两种方式的差异导致了当两个SDK结合到一个程序里的时候就容易出错。细心的朋友应该可以发现一个问题，百度地图SDK里的动态链接库只有一个armeabi文件夹，但是ArcGIS SDK却有两个文件夹，armeabi和armeabi-v7a，其中均有一个libruntimecore_java.so库文件。</p><p>　　这两个文件夹是何用意呢？armeabi和armeabi-v7a是表示cpu的类型，不同的cpu的特性不一样，armeabi就是针对普通的或旧的arm cpu，armeabi-v7a是针对有浮点运算或高级扩展功能的arm cpu。简单来说，Android为了适应五花八门各式各样的智能终端硬件环境，采用了不同的配置对应不同文件夹的调用模式，好比大家熟悉的不同屏幕dpi会调用不同的图片文件夹，如下图。</p><p><img src="https://upload-images.jianshu.io/upload_images/3832962-f6921db227752f31.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="适配"></p><p>　　那么关键的来了，当我们严格按照两个SDK添加链接库后，百度地图三个so库文件就存放在armeabi文件夹下，而armeabi-v7a文件夹下并没有百度地图相应的so库，但ArcGIS却在两个文件夹下都有相应的so库，这里不得不说，Esri作为GIS、地图领域的世界领头羊，考虑的还是比较细。</p><p>　　然后编译程序时，Eclipse会在两个文件夹里搜索相应的库文件，而只会根据Android手机的具体情况拷贝相应文件夹下的库文件。当今绝大多数的手机已经具备了针对有浮点运算或高级扩展功能的arm cpu，所以在<a href="https://www.baidu.com/s?wd=%E6%89%8B%E6%9C%BA%E6%A0%B9%E7%9B%AE%E5%BD%95&amp;tn=44039180_cpr&amp;fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1Y4nynznj63PWIhPvRkPjPb0ZwV5Hcvrjm3rH6sPfKWUMw85HfYnjn4nH6sgvPsT6KdThsqpZwYTjCEQLGCpyw9Uz4Bmy-bIi4WUvYETgN-TLwGUv3EnWcvP1DzrHb3PWf4nj01nHb3r0" target="_blank" rel="noopener">手机根目录</a>下/data/data/(program_name)/lib下只会拷贝armeabi-v7a文件夹下的库文件，而此时并不会有百度地图的so库文件。从而会导致百度地图SDK程序直接崩溃，并报出java.lang.ExceptionInInitializerError错误。</p><p>　　明白了原理，解决办法就十分简单了，将armeabi文件夹下百度地图的so库文件拷贝到armeabi-v7a文件夹下，如下图：</p><p><img src="https://upload-images.jianshu.io/upload_images/3832962-c48da4c8cfa52a5b.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="拷贝文件"></p><p>　　重新clean一下project，重新编译后程序就可以正常调用百度地图和ArcGIS两个SDK库了。</p><blockquote><p>注：这里由于我是直接用的Jcenter仓库中的ArcGIS 10.2.9库，只有三个文件夹，而目前百度定位SDK已经适配了所有类型处理器，所以我的操作是删除百度地图中多出来的几个文件夹。</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;【参考链接：&lt;a href=&quot;https://zhidao.baidu.com/question/2267129986490031988.html】&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://zhidao.baidu.com/quest
      
    
    </summary>
    
      <category term="ArcGIS" scheme="http://www.lifayu.com/categories/ArcGIS/"/>
    
      <category term="ArcGIS Runtime for Android" scheme="http://www.lifayu.com/categories/ArcGIS/ArcGIS-Runtime-for-Android/"/>
    
    
      <category term="ArcGIS" scheme="http://www.lifayu.com/tags/ArcGIS/"/>
    
      <category term="ArcGIS Runtime" scheme="http://www.lifayu.com/tags/ArcGIS-Runtime/"/>
    
  </entry>
  
  <entry>
    <title>git pull 如何强制覆盖本地文件</title>
    <link href="http://www.lifayu.com/2019/01/11/pull-%E5%A6%82%E4%BD%95%E5%BC%BA%E5%88%B6%E8%A6%86%E7%9B%96%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6/"/>
    <id>http://www.lifayu.com/2019/01/11/pull-如何强制覆盖本地文件/</id>
    <published>2019-01-10T19:06:56.000Z</published>
    <updated>2019-01-10T11:14:43.007Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>原文链接：<br><a href="https://vimsky.com/article/3679.html" target="_blank" rel="noopener">https://vimsky.com/article/3679.html</a></p></blockquote><p>##【需求】<br>在开发中使用Git的过程中，有时候会有一种需求，要从服务器拉取最新的状态，而本地进行了无关紧要的修改，这时候如果使用<code>git pull</code>命令，会提示本地有未缓存的修改。这时候就需要强制覆盖本地的改变。</p><a id="more"></a><p>##【最佳解决方案】</p><blockquote><p><strong>重要提示：如果您有任何本地更改，将会丢失。无论是否有–hard选项，任何未被推送的本地提交都将丢失。</strong><br>如果您有任何未被Git跟踪的文件(例如上传的用户内容)，这些文件将不会受到影响。<br>下面是正确的方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git fetch --all</span><br></pre></td></tr></table></figure></p></blockquote><p>然后，你有两个选择：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard origin/master</span><br></pre></td></tr></table></figure></p><p>或者如果你在其他分支上：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard origin/&lt;branch_name&gt;</span><br></pre></td></tr></table></figure></p><p>###说明：<br><code>git fetch</code>从远程下载最新的，而不尝试合并或rebase任何东西。</p><p>然后<code>git reset</code>将主分支重置为您刚刚获取的内容。 <code>--hard</code>选项更改工作树中的所有文件以匹配<code>origin/master</code>中的文件</p><p>在重置之前可以通过从master创建一个分支来维护当前的本地提交：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git checkout master</span><br><span class="line">git branch new-branch-to-save-current-commits</span><br><span class="line">git fetch --all</span><br><span class="line">git reset --hard origin/master</span><br></pre></td></tr></table></figure></p><p>在此之后，所有旧的提交都将保存在new-branch-to-save-current-commits中。然而，没有提交的更改(即使staged)将会丢失。确保存储和提交任何你需要的东西。</p><p>##【次佳解决方案】<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard HEAD</span><br><span class="line">git pull</span><br></pre></td></tr></table></figure></p><p>##【第三种解决方法】</p><blockquote><p><strong>警告：<code>git clean</code>删除所有未跟踪的文件/目录，不能撤消。</strong></p></blockquote><p>有的时候只有<code>clean -f</code>无效。如果你没有跟踪DIRECTORIES，<code>-d</code>选项也需要：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard HEAD</span><br><span class="line">git clean -f -d</span><br><span class="line">git pull</span><br></pre></td></tr></table></figure></p><p>##【第四种方法】<br>可行的方式是通过使用<code>fetch</code>和<code>merge</code>定义的策略。这应该能使你的本地修改保留下来，只要它们不是你试图强制覆盖的文件之一。</p><p>首先做一个你的改变<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git add *</span><br><span class="line">git commit -a -m &quot;local file server commit message&quot;</span><br></pre></td></tr></table></figure></p><p>然后获取更改并覆盖，如果有冲突<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git fetch origin master</span><br><span class="line">git merge -s recursive -X theirs origin/master</span><br></pre></td></tr></table></figure></p><p>“-X”是选项名称，”theirs”是该选项的值。如果存在冲突，则选择使用”their”更改，而不是”your”更改。</p><p>##【第五种方法】<br>这是另外的思路，不建议上文的做法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git fetch --all</span><br><span class="line">git reset --hard origin/master</span><br></pre></td></tr></table></figure></p><p>而是建议这样做：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git fetch origin master</span><br><span class="line">git reset --hard origin/master</span><br></pre></td></tr></table></figure></p><p>如果你打算重新设置原点/主分支，没有必要获取所有的遥控器和分支</p><p>##【第六种方法】<br>看起来最好的办法是先做：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clean</span><br></pre></td></tr></table></figure></p><p>删除所有未跟踪的文件，然后继续使用通常的<code>git pull ...</code></p><p>##【第七种方法】<br>所有这些解决方案的问题是，它们都是太复杂，或者更大的问题是，他们从Web服务器中删除所有未跟踪的文件，这是我们不想要的，因为总是有需要的配置文件服务器，而不是在Git仓库。</p><p>这是我们正在使用的最干净的解决方案：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># Fetch the newest code</span><br><span class="line">git fetch</span><br><span class="line"></span><br><span class="line"># Delete all files which are being added, so there</span><br><span class="line"># are no conflicts with untracked files</span><br><span class="line">for file in `git diff HEAD..origin/master --name-status | awk &apos;/^A/ &#123;print $2&#125;&apos;`</span><br><span class="line">do</span><br><span class="line">    rm -f -- &quot;$file&quot;</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"># Checkout all files which were locally modified</span><br><span class="line">for file in `git diff --name-status | awk &apos;/^[CDMRTUX]/ &#123;print $2&#125;&apos;`</span><br><span class="line">do</span><br><span class="line">    git checkout -- &quot;$file&quot;</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"># Finally pull all the changes</span><br><span class="line"># (you could merge as well e.g. &apos;merge origin/master&apos;)</span><br><span class="line">git pull</span><br></pre></td></tr></table></figure></p><p>第一个命令获取最新的数据。</p><p>第二个命令检查是否有任何正在添加到存储库的文件，并从本地存储库中删除那些会导致冲突的未跟踪文件。</p><p>第三个命令<code>checks-out</code>所有在本地修改的文件。</p><p>最后，我们将更新到最新版本，但是这次没有任何冲突，因为repo中的未跟踪文件不再存在，所有本地修改的文件已经与存储库中的相同。</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;原文链接：&lt;br&gt;&lt;a href=&quot;https://vimsky.com/article/3679.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://vimsky.com/article/3679.html&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;##【需求】&lt;br&gt;在开发中使用Git的过程中，有时候会有一种需求，要从服务器拉取最新的状态，而本地进行了无关紧要的修改，这时候如果使用&lt;code&gt;git pull&lt;/code&gt;命令，会提示本地有未缓存的修改。这时候就需要强制覆盖本地的改变。&lt;/p&gt;
    
    </summary>
    
      <category term="Git" scheme="http://www.lifayu.com/categories/Git/"/>
    
    
      <category term="Git" scheme="http://www.lifayu.com/tags/Git/"/>
    
  </entry>
  
  <entry>
    <title>Git随笔</title>
    <link href="http://www.lifayu.com/2019/01/11/Git%E9%9A%8F%E7%AC%94/"/>
    <id>http://www.lifayu.com/2019/01/11/Git随笔/</id>
    <published>2019-01-10T19:06:56.000Z</published>
    <updated>2019-01-10T11:07:13.813Z</updated>
    
    <content type="html"><![CDATA[<p>##1.推送本地分支到远程仓库<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push</span><br></pre></td></tr></table></figure></p><p>如果远程分支不存在<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push --set-upstream origin [branch_name]</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;##1.推送本地分支到远程仓库&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class
      
    
    </summary>
    
      <category term="Git" scheme="http://www.lifayu.com/categories/Git/"/>
    
    
      <category term="Git" scheme="http://www.lifayu.com/tags/Git/"/>
    
  </entry>
  
  <entry>
    <title>使用Arduino IDE开发ESP8266模块应用</title>
    <link href="http://www.lifayu.com/2019/01/11/%E4%BD%BF%E7%94%A8Arduino-IDE%E5%BC%80%E5%8F%91ESP8266%E6%A8%A1%E5%9D%97%E5%BA%94%E7%94%A8/"/>
    <id>http://www.lifayu.com/2019/01/11/使用Arduino-IDE开发ESP8266模块应用/</id>
    <published>2019-01-10T19:05:57.000Z</published>
    <updated>2019-01-10T11:06:39.734Z</updated>
    
    <content type="html"><![CDATA[<p>##一、添加网址<br>打开Arduino IDE，在<code>文件</code>-&gt;<code>首选项</code>菜单中的<code>附加开发板管理器网址</code>中填写如下网址：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://arduino.esp8266.com/stable/package_esp8266com_index.json</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/3832962-c17c611e9cc6d367.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="附加开发板管理器网址"></p><p>##二、下载开发板定义<br>打开<code>工具</code>-&gt;<code>开发板</code>-&gt;<code>开发板管理器</code>中输入<code>ESP8266</code>，在结果中选择最新版本，并点击安装。<br><img src="https://upload-images.jianshu.io/upload_images/3832962-12ca41f309f35019.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="下载开发板定义"></p><p>##三、选择开发板<br>最后在<code>工具</code>-&gt;<code>开发板</code>根据自己的需求选择对应的型号即可。<br>我个人需要用到<code>WeMos D1 R1</code>开发板。<br><img src="https://upload-images.jianshu.io/upload_images/3832962-35dbe90e79fe8449.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="WeMos D1 R1"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;##一、添加网址&lt;br&gt;打开Arduino IDE，在&lt;code&gt;文件&lt;/code&gt;-&amp;gt;&lt;code&gt;首选项&lt;/code&gt;菜单中的&lt;code&gt;附加开发板管理器网址&lt;/code&gt;中填写如下网址：&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;ta
      
    
    </summary>
    
      <category term="Arduino" scheme="http://www.lifayu.com/categories/Arduino/"/>
    
    
      <category term="物联网" scheme="http://www.lifayu.com/tags/%E7%89%A9%E8%81%94%E7%BD%91/"/>
    
      <category term="IOT" scheme="http://www.lifayu.com/tags/IOT/"/>
    
      <category term="Arduino" scheme="http://www.lifayu.com/tags/Arduino/"/>
    
      <category term="ESP8266" scheme="http://www.lifayu.com/tags/ESP8266/"/>
    
  </entry>
  
  <entry>
    <title>ArcGIS打开后一片空白</title>
    <link href="http://www.lifayu.com/2019/01/11/ArcGIS%E6%89%93%E5%BC%80%E5%90%8E%E4%B8%80%E7%89%87%E7%A9%BA%E7%99%BD/"/>
    <id>http://www.lifayu.com/2019/01/11/ArcGIS打开后一片空白/</id>
    <published>2019-01-10T19:05:22.000Z</published>
    <updated>2019-01-10T11:05:41.113Z</updated>
    
    <content type="html"><![CDATA[<p>##问题<br>最近用到ArcGIS10.2版本。把电脑上的10.1版本卸载了之后，重新安装10.2.2版本，打开之后却是一片空白，如下图：<br><img src="https://upload-images.jianshu.io/upload_images/3832962-c5b491ed9a007e81.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ArcGIS 10.2"></p><p>##解决<br>打开资源管理器，在地址栏中输入：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%USERPROFILE%\Application Data\ESRI\Desktop10.2\ArcMap\Templates</span><br></pre></td></tr></table></figure></p><p>如果提示<code>Application Data</code>目录没有权限，参照【<a href="https://www.jianshu.com/p/24062f791399】获取所有权，然后再次进入上述目录，找到其中的`Normal.mxt`文件，将其删除。然后重新打开`ArcMap`就可以了。" target="_blank" rel="noopener">https://www.jianshu.com/p/24062f791399】获取所有权，然后再次进入上述目录，找到其中的`Normal.mxt`文件，将其删除。然后重新打开`ArcMap`就可以了。</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;##问题&lt;br&gt;最近用到ArcGIS10.2版本。把电脑上的10.1版本卸载了之后，重新安装10.2.2版本，打开之后却是一片空白，如下图：&lt;br&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/383296
      
    
    </summary>
    
      <category term="ArcGIS" scheme="http://www.lifayu.com/categories/ArcGIS/"/>
    
    
      <category term="ArcGIS" scheme="http://www.lifayu.com/tags/ArcGIS/"/>
    
  </entry>
  
  <entry>
    <title>ArcObjects开发初探</title>
    <link href="http://www.lifayu.com/2019/01/11/ArcObjects%E5%BC%80%E5%8F%91%E5%88%9D%E6%8E%A2/"/>
    <id>http://www.lifayu.com/2019/01/11/ArcObjects开发初探/</id>
    <published>2019-01-10T19:04:23.000Z</published>
    <updated>2019-01-10T11:05:04.412Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>最近项目中需要用到ArcGIS二次开发，由于本人并不是地理信息专业科班出身，所以使用过程中遇到很多问题不知道怎么去解决，百度良久，在此记录一番！<br><strong>本文随时更新！</strong></p></blockquote><p>##一、初始化许可<br>ArcObjects是ArcGIS的底层API，基于COM技术搭建，所以能够自然地支持C++，VB，.Net在内的多种语言。然而也因为是基于COM的，所以它的API很是难用（相比.Net framework那样的）。<br>我的系统是<code>Windows 10 专业版 64位</code>+<code>VS 2015</code>+<code>ArcGIS 10.2</code>，考虑到64位的开发环境和运行环境，首先需要在项目中设置平台为<code>x86</code>。<br><img src="https://upload-images.jianshu.io/upload_images/3832962-dd0d730c2de6c056.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="设置项目目标平台为x86"></p><p>在调用其他ArcObjects API之前，首先得初始化许可。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">using ESRI.ArcGIS;</span><br><span class="line">using ESRI.ArcGIS.esriSystem;</span><br><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Windows.Forms;</span><br><span class="line"></span><br><span class="line">namespace 数据处理</span><br><span class="line">&#123;</span><br><span class="line">    static class Program</span><br><span class="line">    &#123;</span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// 应用程序的主入口点。</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        [STAThread]</span><br><span class="line">        static void Main()</span><br><span class="line">        &#123;</span><br><span class="line">            //绑定Runtime</span><br><span class="line">            if (!RuntimeManager.Bind(ProductCode.EngineOrDesktop))</span><br><span class="line">            &#123;</span><br><span class="line">                MessageBox.Show(&quot;不能绑定ArcGIS runtime，应用程序即将关闭.&quot;);</span><br><span class="line">                return;</span><br><span class="line">            &#125;           </span><br><span class="line">            // 初始化AO许可</span><br><span class="line">            var aoi = new AoInitialize();</span><br><span class="line">            var s = aoi.Initialize(</span><br><span class="line">                esriLicenseProductCode.esriLicenseProductCodeEngineGeoDB);</span><br><span class="line"></span><br><span class="line">            if (s == esriLicenseStatus.esriLicenseUnavailable)</span><br><span class="line">                throw new NotSupportedException(&quot;请求的许可不可用&quot;);</span><br><span class="line"></span><br><span class="line">            Application.EnableVisualStyles();</span><br><span class="line">            Application.SetCompatibleTextRenderingDefault(false);</span><br><span class="line">            Application.Run(new FrmMain());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;最近项目中需要用到ArcGIS二次开发，由于本人并不是地理信息专业科班出身，所以使用过程中遇到很多问题不知道怎么去解决，百度良久，在此记录一番！&lt;br&gt;&lt;strong&gt;本文随时更新！&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;##
      
    
    </summary>
    
      <category term="ArcGIS" scheme="http://www.lifayu.com/categories/ArcGIS/"/>
    
    
      <category term="ArcGIS" scheme="http://www.lifayu.com/tags/ArcGIS/"/>
    
      <category term="ArcObjects" scheme="http://www.lifayu.com/tags/ArcObjects/"/>
    
  </entry>
  
  <entry>
    <title>Windows ZIP版MySQL安装方法</title>
    <link href="http://www.lifayu.com/2019/01/11/Windows-ZIP%E7%89%88MySQL%E5%AE%89%E8%A3%85%E6%96%B9%E6%B3%95/"/>
    <id>http://www.lifayu.com/2019/01/11/Windows-ZIP版MySQL安装方法/</id>
    <published>2019-01-10T19:03:45.000Z</published>
    <updated>2019-01-10T11:04:06.910Z</updated>
    
    <content type="html"><![CDATA[<p>##【下载地址】<br><a href="https://dev.mysql.com/downloads/mysql/" target="_blank" rel="noopener">https://dev.mysql.com/downloads/mysql/</a><br>直接下载地址：<a href="https://cdn.mysql.com//Downloads/MySQL-8.0/mysql-8.0.13-winx64.zip" target="_blank" rel="noopener">https://cdn.mysql.com//Downloads/MySQL-8.0/mysql-8.0.13-winx64.zip</a><br>我用的社区免费版。</p><p>##1.解压<br>下载完成后解压缩，我的解压到了<code>D:\Program Files\mysql-8.0.13-winx64</code>目录下。</p><p>##2.安装</p><p>###2.1 初始化<br>以管理员身份运行cmd，转到MySQL目录下的<code>bin</code>文件夹下：<br><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> D:\Program Files\mysql-<span class="number">8</span>.<span class="number">0</span>.<span class="number">13</span>-winx64\bin</span><br></pre></td></tr></table></figure></p><p>然后执行初始化命令：<br><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqld --initialize</span><br></pre></td></tr></table></figure></p><p>执行这条命令之后，在<code>data</code>目录会生成一系列文件，如图：<br><img src="https://upload-images.jianshu.io/upload_images/3832962-a3ab3aa84bea24ce.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="data目录"></p><p>###2.2 安装<br>执行如下命令进行安装：<br><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqld -install</span><br></pre></td></tr></table></figure></p><p>然后，启动服务：<br><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> mysql</span><br></pre></td></tr></table></figure></p><p>如果顺利，会提示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MySQL 服务正在启动...</span><br><span class="line">MySQL 服务已经启动成功。</span><br></pre></td></tr></table></figure></p><p>##3.登陆<br>我用的是<a href="https://dev.mysql.com/downloads/workbench/" target="_blank" rel="noopener">MySQL Workbench</a>软件登陆的。</p><p>打开软件，选择<code>Database -&gt; Connect to Database...</code>：<br><img src="https://upload-images.jianshu.io/upload_images/3832962-c977369a5ddf3874.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="MySQL Workbench"></p><p>连接选择<code>Local instance MySQL</code>，其他默认不变。<br><img src="https://upload-images.jianshu.io/upload_images/3832962-8a1dff0bbcec4be6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="连接数据库"></p><blockquote><p><strong>关于密码</strong><br>新版本的MySQL在第二步安装启动服务时，会生成一个默认初始密码，这个密码存储在<code>data</code>目录下的<strong>`*</strong>.err<code>**文件夹中，用记事本打开此文件，找到</code>A temporary password is generated for root@localhost:… …`这一行，后面即为默认临时密码。<br><img src="https://upload-images.jianshu.io/upload_images/3832962-7f3f8814948c536d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="临时密码"></p></blockquote><p>将上述方法得到的密码填写到对话框的<code>Store in Vault</code>对话框中：<br><img src="https://upload-images.jianshu.io/upload_images/3832962-5684e909e520af57.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="输入密码"><br>然后点击OK，第一次登陆会提示修改密码，按照提示操作修改即可。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;##【下载地址】&lt;br&gt;&lt;a href=&quot;https://dev.mysql.com/downloads/mysql/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://dev.mysql.com/downloads/mysql/&lt;/a&gt;&lt;br
      
    
    </summary>
    
      <category term="MySQL" scheme="http://www.lifayu.com/categories/MySQL/"/>
    
    
      <category term="MySQL" scheme="http://www.lifayu.com/tags/MySQL/"/>
    
      <category term="Windows" scheme="http://www.lifayu.com/tags/Windows/"/>
    
  </entry>
  
  <entry>
    <title>Java连接MySQL问题记录</title>
    <link href="http://www.lifayu.com/2019/01/11/Java%E8%BF%9E%E6%8E%A5MySQL%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    <id>http://www.lifayu.com/2019/01/11/Java连接MySQL问题记录/</id>
    <published>2019-01-10T19:02:58.000Z</published>
    <updated>2019-01-10T11:03:22.997Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>最近学习Java服务器开发，需要用到MySQL数据库连接，在此记录一下遇到的问题及解决方案。</p></blockquote><hr><p>##连接MySQL<br>按照<a href="http://www.runoob.com/java/java-mysql-connect.html" target="_blank" rel="noopener">RUNOOB.COM</a>的教程，连接MySQL数据库，Java代码为：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MySQLDemo</span> </span>&#123; </span><br><span class="line">    <span class="comment">// JDBC 驱动名及数据库 URL</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> String JDBC_DRIVER = <span class="string">"com.mysql.jdbc.Driver"</span>;  </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> String DB_URL = <span class="string">"jdbc:mysql://localhost:3306/RUNOOB"</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// 数据库的用户名与密码，需要根据自己的设置</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> String USER = <span class="string">"root"</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> String PASS = <span class="string">"123456"</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">connectTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Connection conn = <span class="keyword">null</span>;</span><br><span class="line">        Statement stmt = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// 注册 JDBC 驱动</span></span><br><span class="line">            Class.forName(JDBC_DRIVER);</span><br><span class="line">        </span><br><span class="line">            <span class="comment">// 打开链接</span></span><br><span class="line">            System.out.println(<span class="string">"连接数据库..."</span>);</span><br><span class="line">            conn = DriverManager.getConnection(DB_URL,USER,PASS);</span><br><span class="line">        </span><br><span class="line">            <span class="comment">// 执行查询</span></span><br><span class="line">            System.out.println(<span class="string">" 实例化Statement对象..."</span>);</span><br><span class="line">            stmt = conn.createStatement();</span><br><span class="line">            String sql;</span><br><span class="line">            sql = <span class="string">"SELECT id, name, url FROM websites"</span>;</span><br><span class="line">            ResultSet rs = stmt.executeQuery(sql);</span><br><span class="line">        </span><br><span class="line">            <span class="comment">// 展开结果集数据库</span></span><br><span class="line">            <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">                <span class="comment">// 通过字段检索</span></span><br><span class="line">                <span class="keyword">int</span> id  = rs.getInt(<span class="string">"id"</span>);</span><br><span class="line">                String name = rs.getString(<span class="string">"name"</span>);</span><br><span class="line">                String url = rs.getString(<span class="string">"url"</span>);</span><br><span class="line">    </span><br><span class="line">                <span class="comment">// 输出数据</span></span><br><span class="line">                System.out.print(<span class="string">"ID: "</span> + id);</span><br><span class="line">                System.out.print(<span class="string">", 站点名称: "</span> + name);</span><br><span class="line">                System.out.print(<span class="string">", 站点 URL: "</span> + url);</span><br><span class="line">                System.out.print(<span class="string">"\n"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 完成后关闭</span></span><br><span class="line">            rs.close();</span><br><span class="line">            stmt.close();</span><br><span class="line">            conn.close();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(SQLException se)&#123;</span><br><span class="line">            <span class="comment">// 处理 JDBC 错误</span></span><br><span class="line">            se.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            <span class="comment">// 处理 Class.forName 错误</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            <span class="comment">// 关闭资源</span></span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(stmt!=<span class="keyword">null</span>) stmt.close();</span><br><span class="line">            &#125;<span class="keyword">catch</span>(SQLException se2)&#123;</span><br><span class="line">            &#125;<span class="comment">// 什么都不做</span></span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(conn!=<span class="keyword">null</span>) conn.close();</span><br><span class="line">            &#125;<span class="keyword">catch</span>(SQLException se)&#123;</span><br><span class="line">                se.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"Goodbye!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>没想到直接运行马上马上就报错了。</p><hr><p>###错误一：Could not create connection to database server - java mysql connector<br>此问题是由于<a href="http://www.runoob.com/java/java-mysql-connect.html" target="_blank" rel="noopener">RUNOOB.COM</a>提供的Jar包过期导致无法连接最新版MySQL数据库。</p><p>####【解决方法】<br><a href="https://pan.baidu.com/s/1jcNaQER0huWi0xX46gIiDQ" target="_blank" rel="noopener">下载最新版的Jar包</a><br>密码： igvz<br>并将代码中的驱动修改一下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// JDBC 驱动名及数据库 URL</span></span><br><span class="line">   <span class="keyword">static</span> <span class="keyword">final</span> String JDBC_DRIVER = <span class="string">"com.mysql.cj.jdbc.Driver"</span>;</span><br></pre></td></tr></table></figure></p><p>###错误二：java.lang.ClassNotFoundException: com.mysql.jdbc.Driver<br>解决了错误一后，接着来了错误二，报错代码为：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 注册 JDBC 驱动</span></span><br><span class="line">Class.forName(JDBC_DRIVER);</span><br></pre></td></tr></table></figure></p><p>此问题是由于<code>tomcat</code>找不到<code>MYSQL JAR</code>包导致的。</p><p>####【解决方法】<br>将上一步下载的<code>mysql-connector-java-8.0.11.jar</code>文件拷贝到<code>tomcat</code>根目录下的<code>lib</code>文件夹中。</p><p>###错误三：java.sql.SQLException: The server time zone value ‘???ú±ê×??±??’ is unrecognized or represents more than one time zone. You must configure either the server or JDBC driver (via the serverTimezone configuration property) to use a more specifc time zone value if you want to utilize time zone support.<br>按照错误信息中的提示，在数据库连接字符串中添加<code>serverTimezone=UTC</code>即可解决。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">static final String DB_URL = &quot;jdbc:mysql://localhost:3306/RUNOOB?serverTimezone=UTC&quot;;</span><br></pre></td></tr></table></figure></p><p>###警告四：WARN: Establishing SSL connection without server’s identity verification is not recommended.<br>输出控制台一直有这个警告，这是由于MySQL要求服务器有SSL验证。</p><p>####【解决方法】<br>继续修改数据库连接字符串，添加<code>useSSL=false</code>参数：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> String DB_URL = <span class="string">"jdbc:mysql://localhost:3306/RUNOOB?useSSL=false&amp;serverTimezone=UTC"</span>;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;最近学习Java服务器开发，需要用到MySQL数据库连接，在此记录一下遇到的问题及解决方案。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;p&gt;##连接MySQL&lt;br&gt;按照&lt;a href=&quot;http://www.runoob.com/java/
      
    
    </summary>
    
      <category term="MySQL" scheme="http://www.lifayu.com/categories/MySQL/"/>
    
    
      <category term="MySQL" scheme="http://www.lifayu.com/tags/MySQL/"/>
    
      <category term="Java" scheme="http://www.lifayu.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>SQLyog连接数据库报错：Plugin caching_sha2_password could not be loaded</title>
    <link href="http://www.lifayu.com/2019/01/11/SQLyog%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8A%A5%E9%94%99%EF%BC%9APlugin-caching-sha2-password-could-not-be-loaded/"/>
    <id>http://www.lifayu.com/2019/01/11/SQLyog连接数据库报错：Plugin-caching-sha2-password-could-not-be-loaded/</id>
    <published>2019-01-10T19:01:48.000Z</published>
    <updated>2019-01-10T11:02:40.741Z</updated>
    
    <content type="html"><![CDATA[<p>##【错误信息】<br>用<code>SQLyog</code>连接<code>MySQL</code>数据库时，第一次连接会报错如下图：<br><img src="https://upload-images.jianshu.io/upload_images/3832962-ee8aa0be5721e44a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="错误信息"></p><p>##【解决方法】</p><p>###1.打开cmd登录数据库<br><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure></p><p>###2.进入mysql依次执行如下命令<br><code>`</code>bat</p><p>#修改加密规则<br>ALTER USER ‘root‘@’localhost’ IDENTIFIED BY ‘password’ PASSWORD EXPIRE NEVER; </p><p>#更新用户的密码<br>ALTER USER ‘root‘@’localhost’ IDENTIFIED WITH mysql_native_password BY ‘password’; </p><p>#刷新权限<br>FLUSH PRIVILEGES;</p><p>#重置密码<br>ALTER USER ‘root‘@’localhost’ IDENTIFIED BY ‘your_password’;</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;##【错误信息】&lt;br&gt;用&lt;code&gt;SQLyog&lt;/code&gt;连接&lt;code&gt;MySQL&lt;/code&gt;数据库时，第一次连接会报错如下图：&lt;br&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/3832962
      
    
    </summary>
    
      <category term="MySQL" scheme="http://www.lifayu.com/categories/MySQL/"/>
    
    
      <category term="MySQL" scheme="http://www.lifayu.com/tags/MySQL/"/>
    
      <category term="SQLyog" scheme="http://www.lifayu.com/tags/SQLyog/"/>
    
  </entry>
  
  <entry>
    <title>CMD命令提示符改编编码命令</title>
    <link href="http://www.lifayu.com/2019/01/11/CMD%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6%E6%94%B9%E7%BC%96%E7%BC%96%E7%A0%81%E5%91%BD%E4%BB%A4/"/>
    <id>http://www.lifayu.com/2019/01/11/CMD命令提示符改编编码命令/</id>
    <published>2019-01-10T19:00:13.000Z</published>
    <updated>2019-01-10T11:01:22.101Z</updated>
    
    <content type="html"><![CDATA[<hr><p>CMD中修改字符编码的命令为 chcp，以下为帮助文档：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\system32&gt;help chcp 显示或设置活动代码页编号。 CHCP [nnn]   nnn</span><br><span class="line">指定代码页编号。 不带参数键入 CHCP 以显示活动代码页编号。</span><br></pre></td></tr></table></figure></p><p>输入:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;chcp 65001</span><br></pre></td></tr></table></figure></p><p>设置编码为UTF-8<br><img src="http://z4a.net/images/2016/06/08/UTF-8.png" alt="UTG-8"></p><p>输入:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chcp 936</span><br></pre></td></tr></table></figure></p><p>设置编码GBK</p><p><img src="http://z4a.net/images/2016/06/08/GBK.png" alt="GBK"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;hr&gt;
&lt;p&gt;CMD中修改字符编码的命令为 chcp，以下为帮助文档：&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;s
      
    
    </summary>
    
      <category term="Windows" scheme="http://www.lifayu.com/categories/Windows/"/>
    
    
      <category term="cmd" scheme="http://www.lifayu.com/tags/cmd/"/>
    
  </entry>
  
  <entry>
    <title>树莓派安装KodExplorer变身私人云桌面</title>
    <link href="http://www.lifayu.com/2019/01/10/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%AE%89%E8%A3%85KodExplorer%E5%8F%98%E8%BA%AB%E7%A7%81%E4%BA%BA%E4%BA%91%E6%A1%8C%E9%9D%A2/"/>
    <id>http://www.lifayu.com/2019/01/10/树莓派安装KodExplorer变身私人云桌面/</id>
    <published>2019-01-09T19:49:56.000Z</published>
    <updated>2019-01-09T11:50:32.159Z</updated>
    
    <content type="html"><![CDATA[<p>标签（空格分隔）： 树莓派 KodExplorer</p><hr><p>【参考链接】<br><a href="http://www.immortalt.com/archives/306" target="_blank" rel="noopener">旧手机安装KodExplorer可道云变身云桌面</a><br><a href="http://blog.csdn.net/emperor10juv/article/details/52705590" target="_blank" rel="noopener">Ubuntu14.04下配置PHP7.0+Apache2+Mysql5.7</a><br><a href="http://m.php.cn/article/341528.html" target="_blank" rel="noopener">ubuntu下使用 apt-get install 安装php扩展库mcrypt、curl、gd</a></p><p>本文主要目的是在树莓派上搭建Apache2 + php7.0 环境，并安装<a href="https://kodcloud.com/download/" target="_blank" rel="noopener">KodCLoud</a>实现私人云。因KodExplorer不需要Mysql环境， 所以暂不安装。</p><p><strong>【更新软件源仓库】</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get upgrade</span><br></pre></td></tr></table></figure></p><p><strong>【安装Apache2】</strong></p><ul><li>安装apache2<br>在树莓派上的终端执行如下命令，<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y apache2</span><br></pre></td></tr></table></figure></li></ul><p>编辑apache主配置文件/etc/apache2/apache2.conf，修改KeepAlive设置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KeepAlive Off</span><br></pre></td></tr></table></figure></p><p>Apache默认的multi-processing模块(MPM ) 是一个event 模块，但是 php默认是使用 prefork模块，禁用event模块，启用prefork模块<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo a2dismod mpm_event</span><br><span class="line">sudo a2enmod mpm_prefork</span><br></pre></td></tr></table></figure></p><p>重启Apache<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service apache2 restart</span><br></pre></td></tr></table></figure></p><ul><li>修改端口<br>进入<code>/etc/apache2/</code>目录下，修改<code>ports.conf</code>文件，添加<code>Listen 端口号</code>即可监听对应端口：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/apache2/</span><br><span class="line">sudo nano ports.conf</span><br></pre></td></tr></table></figure></li></ul><p>添加内容，每行一条记录:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># If you just change the port or add more ports here, you will likely also</span><br><span class="line"># have to change the VirtualHost statement in</span><br><span class="line"># /etc/apache2/sites-enabled/000-default.conf</span><br><span class="line"></span><br><span class="line">Listen 80</span><br><span class="line">Listen 8000</span><br><span class="line"></span><br><span class="line">...其他内容..</span><br></pre></td></tr></table></figure></p><p>同时，按照文件头部的说明，还要修改<code>/etc/apache2/sites-enabled/000-default.conf</code>文件中的<code>VirtualHost</code>声明<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/apache2/sites-enabled/</span><br><span class="line">sudo nano 000-default.conf</span><br></pre></td></tr></table></figure></p><p>在<code>VirtualHost *:80&gt;</code>节点修改端口号即可：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;VirtualHost *:8000&gt;</span><br><span class="line">    **其他内容**</span><br><span class="line">&lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure></p><p><strong>【安装PHP7.0】</strong><br>如果系统是jessie，需要假如stretch源才能安装php7，速度相比php5快一倍：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/apt/sources.list</span><br></pre></td></tr></table></figure></p><p>添加一行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deb http://mirrordirector.raspbian.org/raspbian/ stretch main contrib non-free rpi</span><br></pre></td></tr></table></figure></p><p>接着创建一个文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/apt/preferences</span><br></pre></td></tr></table></figure></p><p>添加以下内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Package: *</span><br><span class="line">Pin: release n=jessie</span><br><span class="line">Pin-Priority: 600</span><br></pre></td></tr></table></figure></p><p>更新源并安装php7.0<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install -t stretch php7.0 php7.0-curl php7.0-gd php7.0-fpm php7.0-cli php7.0-opcache php7.0-mbstring php7.0-xml php7.0-zip</span><br></pre></td></tr></table></figure></p><p>安装好之后执行 php -v 可以查看版本。</p><blockquote><p>如果这一步出现公钥问题，参照另一篇文章：<br><a href="https://www.jianshu.com/p/8a1921413fad" target="_blank" rel="noopener">https://www.jianshu.com/p/8a1921413fad</a><br>即可解决问题。</p></blockquote><p><strong>【LAMP】</strong></p><ul><li>整合PHP和Apache2<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install libapache2-mod-php7.0</span><br><span class="line">sudo service apache2 restart</span><br></pre></td></tr></table></figure></li></ul><p><strong>【验证环境】</strong></p><ul><li><p>显示PHP的版本信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -v</span><br></pre></td></tr></table></figure></li><li><p><strong>Apache默认的网站根目录位于<code>/var/www/html/</code></strong>,进入这个目录，并创建info.php</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /var/www/html/info.php</span><br></pre></td></tr></table></figure></li></ul><p>写入如下内容：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    phpinfo();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>在浏览器中输入<a href="http://localhost/info.php进行验证。" target="_blank" rel="noopener">http://localhost/info.php进行验证。</a><br><strong>【KodExplorer】</strong><br>按照 <a href="https://kodcloud.com/download/" target="_blank" rel="noopener">https://kodcloud.com/download/</a> 页面的说明，下载KodExplorer并安装：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /var/www/html/</span><br><span class="line">wget http://static.kodcloud.com/update/download/kodexplorer4.25.zip</span><br><span class="line">unzip kodexplorer4.25.zip</span><br><span class="line">chmod -Rf 777 ./*</span><br></pre></td></tr></table></figure></p><p>最后在浏览器输入<code>http://localhost:8000/index.php</code>，如果一切正常即可看到网盘页面。<br><strong>【内网穿透】</strong><br>这一部分不是重点，所以简单介绍一种方法来实现远程访问。<br>从 <a href="https://ngrok.com/download" target="_blank" rel="noopener">https://ngrok.com/download</a> 页面下载<code>ngrok</code>，树莓派选择<code>Linux(ARM)</code>版本进行下载。<br>或者从这里下载并上传到树莓派：<a href="https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-arm.zip" target="_blank" rel="noopener">https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-arm.zip</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /home/pi/Desktop/</span><br><span class="line">wget https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-arm.zip</span><br><span class="line">sudo unzip ngrok-stable-linux-arm.zip</span><br><span class="line">sudo ./ngrok http 80  #这里演示的是80端口，其他端口未测试。</span><br></pre></td></tr></table></figure></p><p>然后在<code>Forwarding</code>后面跟着的<code>ip:ports -&gt; localhost:80</code>即为远程映射地址。<br>在任意浏览器输入上面的<code>ip:ports</code>即可访问到本地服务。</p><p><strong>【安装Mysql5.7】</strong></p><ul><li><p>因为Ubuntu14.04下没有Mysql5.7的源，需要连接外部资源库进行下载</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget http://dev.mysql.com/get/mysql-apt-config_0.6.0-1_all.deb</span><br><span class="line">sudo dpkg -i mysql-apt-config_0.6.0-1_all.deb</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install mysql-server</span><br><span class="line"># 在安装过程中要输入root的密码</span><br></pre></td></tr></table></figure></li><li><p>安装完成后，执行mysql_secure_installation，根据提示完成安全设置</p><blockquote><p>这一步骤中，在手机上用<code>linux deploy</code>部署linux执行有可能出现错误<br>W: GPG error: <a href="http://rep.mysql.com/apt/debian" target="_blank" rel="noopener">http://rep.mysql.com/apt/debian</a> jessie InRelease: The following signatures were invalid: KEYEXPIRED 1487236823  KEYEXPIRED 1487236823  KEYEXPIRED 1487236823<br>w: The repository ‘<a href="http://repo.mysql.com/apt/debian" target="_blank" rel="noopener">http://repo.mysql.com/apt/debian</a> jessie InRelease’ is not signed.<br>按照<a href="https://askubuntu.com/questions/131601/gpg-error-release-the-following-signatures-were-invalid-badsig" target="_blank" rel="noopener">https://askubuntu.com/questions/131601/gpg-error-release-the-following-signatures-were-invalid-badsig</a>中的方法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; sudo apt-get clean</span><br><span class="line">&gt; sudo mv /var/lib/apt/lists /tmp</span><br><span class="line">&gt; sudo mkdir -p /var/lib/apt/lists/partial  #这一句可以不执行，update的时候会自动执行</span><br><span class="line">&gt; sudo apt-get clean</span><br><span class="line">&gt; sudo apt-get update</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote></li></ul><blockquote><p>依次执行上面的命令后即可重新安装其他版本的mysql。</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;标签（空格分隔）： 树莓派 KodExplorer&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;【参考链接】&lt;br&gt;&lt;a href=&quot;http://www.immortalt.com/archives/306&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;旧手机安装KodEx
      
    
    </summary>
    
      <category term="树莓派" scheme="http://www.lifayu.com/categories/%E6%A0%91%E8%8E%93%E6%B4%BE/"/>
    
    
      <category term="树莓派" scheme="http://www.lifayu.com/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/"/>
    
      <category term="KodExplorer" scheme="http://www.lifayu.com/tags/KodExplorer/"/>
    
  </entry>
  
  <entry>
    <title>Raspbian 中国软件源</title>
    <link href="http://www.lifayu.com/2019/01/10/Raspbian-%E4%B8%AD%E5%9B%BD%E8%BD%AF%E4%BB%B6%E6%BA%90/"/>
    <id>http://www.lifayu.com/2019/01/10/Raspbian-中国软件源/</id>
    <published>2019-01-09T19:46:59.000Z</published>
    <updated>2019-01-09T11:47:40.902Z</updated>
    
    <content type="html"><![CDATA[<p>标签： 树莓派</p><hr><p>本文来自：<a href="http://shumeipai.nxez.com/" title="http://shumeipai.nxez.com/" target="_blank" rel="noopener">树莓派实验室</a><br>链接地址：<a href="http://shumeipai.nxez.com/2013/08/31/raspbian-chinese-software-source.html" target="_blank" rel="noopener">http://shumeipai.nxez.com/2013/08/31/raspbian-chinese-software-source.html</a></p><p>花了些时间整理了目前最新的树莓派中国大陆地区的软件源，记下来，希望对大家有帮助。</p><p>中国科学技术大学<br>Raspbian <a href="http://mirrors.ustc.edu.cn/raspbian/raspbian/" target="_blank" rel="noopener">http://mirrors.ustc.edu.cn/raspbian/raspbian/</a></p><p>阿里云<br>Raspbian <a href="http://mirrors.aliyun.com/raspbian/raspbian/" target="_blank" rel="noopener">http://mirrors.aliyun.com/raspbian/raspbian/</a></p><p>清华大学<br>Raspbian <a href="http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/" target="_blank" rel="noopener">http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/</a></p><p>华中科技大学<br>Raspbian <a href="http://mirrors.hustunique.com/raspbian/raspbian/" target="_blank" rel="noopener">http://mirrors.hustunique.com/raspbian/raspbian/</a><br>Arch Linux ARM <a href="http://mirrors.hustunique.com/archlinuxarm/" target="_blank" rel="noopener">http://mirrors.hustunique.com/archlinuxarm/</a></p><p>华南农业大学（华南用户）<br>Raspbian <a href="http://mirrors.scau.edu.cn/raspbian/" target="_blank" rel="noopener">http://mirrors.scau.edu.cn/raspbian/</a></p><p>大连东软信息学院源（北方用户）<br>Raspbian <a href="http://mirrors.neusoft.edu.cn/raspbian/raspbian/" target="_blank" rel="noopener">http://mirrors.neusoft.edu.cn/raspbian/raspbian/</a></p><p>重庆大学源（中西部用户）<br>Raspbian <a href="http://mirrors.cqu.edu.cn/Raspbian/raspbian/" target="_blank" rel="noopener">http://mirrors.cqu.edu.cn/Raspbian/raspbian/</a></p><p>中山大学 已跳转至中国科学技术大学源<br>Raspbian <a href="http://mirror.sysu.edu.cn/raspbian/raspbian/" target="_blank" rel="noopener">http://mirror.sysu.edu.cn/raspbian/raspbian/</a></p><p>新加坡国立大学<br>Raspbian <a href="http://mirror.nus.edu.sg/raspbian/raspbian" target="_blank" rel="noopener">http://mirror.nus.edu.sg/raspbian/raspbian</a></p><p>牛津大学<br>Raspbian <a href="http://mirror.ox.ac.uk/sites/archive.raspbian.org/archive/raspbian/" target="_blank" rel="noopener">http://mirror.ox.ac.uk/sites/archive.raspbian.org/archive/raspbian/</a></p><p>韩国KAIST大学<br>Raspbian <a href="http://ftp.kaist.ac.kr/raspbian/raspbian/" target="_blank" rel="noopener">http://ftp.kaist.ac.kr/raspbian/raspbian/</a></p><p>使用说明<br>编辑<code>/etc/apt/sources.list</code> 文件，参考如下命令：<br><code>sudo nano /etc/apt/sources.list</code><br>删除原文件所有内容，jessie 用以下内容取代：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deb http://mirror.sysu.edu.cn/raspbian/raspbian/ jessie main contrib non-free</span><br><span class="line">deb-src http://mirror.sysu.edu.cn/raspbian/raspbian/ jessie main contrib non-free</span><br></pre></td></tr></table></figure></p><p>wheezy 用以下内容取代：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deb http://mirror.sysu.edu.cn/raspbian/raspbian/ wheezy main contrib non-free</span><br><span class="line">deb-src http://mirror.sysu.edu.cn/raspbian/raspbian/ wheezy main contrib non-free</span><br></pre></td></tr></table></figure></p><p>注：网址末尾的raspbian重复两次是必须的。因为Raspbian的仓库中除了APT软件源还包含其他代码。APT软件源不在仓库的根目录，而在raspbian/子目录下。</p><p>编辑镜像站后，请使用<code>sudo apt-get update</code>命令，更新软件源列表，同时检查您的编辑是否正确。<br>如果需要, 你可以执行以下命令将Raspbian public key加入你的 apt-get keyring :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://archive.raspbian.org/raspbian.public.key -O - | sudo apt-key add -</span><br></pre></td></tr></table></figure></p><blockquote><p>2015.11.23 add a update from comments：<br>现在版本升级了，版本号要更改，把 wheezy 改成 jessie &gt; 这样大部分源是在中国，不然像楼上那样升级，大部分源在国外</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;标签： 树莓派&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;本文来自：&lt;a href=&quot;http://shumeipai.nxez.com/&quot; title=&quot;http://shumeipai.nxez.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;树莓派实验室&lt;/a
      
    
    </summary>
    
      <category term="树莓派" scheme="http://www.lifayu.com/categories/%E6%A0%91%E8%8E%93%E6%B4%BE/"/>
    
    
      <category term="树莓派" scheme="http://www.lifayu.com/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/"/>
    
      <category term="软件源" scheme="http://www.lifayu.com/tags/%E8%BD%AF%E4%BB%B6%E6%BA%90/"/>
    
  </entry>
  
  <entry>
    <title>【转载】Linux启动项管理：Update-rc.d 命令用法详解</title>
    <link href="http://www.lifayu.com/2019/01/10/%E3%80%90%E8%BD%AC%E8%BD%BD%E3%80%91Linux%E5%90%AF%E5%8A%A8%E9%A1%B9%E7%AE%A1%E7%90%86%EF%BC%9AUpdate-rc-d-%E5%91%BD%E4%BB%A4%E7%94%A8%E6%B3%95%E8%AF%A6%E8%A7%A3/"/>
    <id>http://www.lifayu.com/2019/01/10/【转载】Linux启动项管理：Update-rc-d-命令用法详解/</id>
    <published>2019-01-09T19:45:34.000Z</published>
    <updated>2019-01-09T11:46:44.526Z</updated>
    
    <content type="html"><![CDATA[<p>标签： Linux Update-rc.d</p><hr><p><strong><em>[原文链接：<a href="http://blog.csdn.net/shb_derek1/article/details/8489112" target="_blank" rel="noopener">Update-rc.d 命令用法详解</a>]</em></strong><br><strong><em>[原文作者：<a href="http://blog.csdn.net/shb_derek1" target="_blank" rel="noopener">Shb_derek</a>]</em></strong></p><p>Ubuntu或者Debian系统中update-rc.d命令，是用来更新系统启动项的脚本。这些脚本的链接位于/etc/rcN.d/目录，对应脚本位于/etc/init.d/目录。在了解update-rc.d命令之前，你需要知道的是有关Linux 系统主要启动步骤，以及Ubuntu中运行级别的知识。</p><p> <strong>一、Linux 系统主要启动步骤</strong><br>读取 MBR 的信息，启动 Boot Manager。<br>加载系统内核，启动 init 进程， init 进程是 Linux 的根进程，所有的系统进程都是它的子进程。<br>init 进程读取 /etc/inittab 文件中的信息，并进入预设的运行级别。通常情况下 /etc/rcS.d/ 目录下的启动脚本首先被执行，然后是/etc/rcN.d/ 目录。<br>根据 /etc/rcS.d/ 文件夹中对应的脚本启动 Xwindow 服务器 xorg，Xwindow 为 Linux 下的图形用户界面系统。<br>启动登录管理器，等待用户登录。</p><p><strong>二、运行级别</strong><br>Ubuntu中的运行级别</p><blockquote><p>0（关闭系统）<br>1（单用户模式，只允许root用户对系统进行维护。）<br>2 到 5（多用户模式，其中3为字符界面，5为图形界面。）<br>6（重启系统）</p></blockquote><p>切换运行级别<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">init [0123456Ss]</span><br><span class="line">例如：init 0 命令关机； init 6 命令重新启动</span><br></pre></td></tr></table></figure></p><p>启动项管理工具<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo install sysv-rc-conf //或者使用带gui的工具bum</span><br><span class="line">sudo sysv-rc-conf</span><br></pre></td></tr></table></figure></p><p><strong>三、update-rc.d命令详解</strong></p><p>从所有的运行级别中删除指定启动项<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update-rc.d -f ＜basename＞ remove</span><br></pre></td></tr></table></figure></p><p>按指定顺序、在指定运行级别中启动或关闭<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update-rc.d ＜basename＞ start|stop ＜order＞ ＜runlevels＞</span><br></pre></td></tr></table></figure></p><p>实例：<code>update-rc.d apachectl start 20 2 3 4 5 . stop 20 0 1 6 .</code></p><p>解析：表示在2、3、4、5这五个运行级别中，由小到大，第20个开始运行apachectl；在 0 1 6这3个运行级别中，第20个关闭apachectl。这是合并起来的写法，注意它有2个点号，效果等于下面方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update-rc.d apachectl defaults</span><br></pre></td></tr></table></figure></p><p>A启动后B才能启动，B关闭后A才关闭<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">update-rc.d A defaults 80 20</span><br><span class="line">update-rc.d B defaults 90 10</span><br></pre></td></tr></table></figure></p><p>启动和关闭顺序为90，级别默认<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update-rc.d ＜basename＞ defaults 90</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;标签： Linux Update-rc.d&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;[原文链接：&lt;a href=&quot;http://blog.csdn.net/shb_derek1/article/details/8489112&quot; target=&quot;_blank&quot; rel
      
    
    </summary>
    
      <category term="Linux" scheme="http://www.lifayu.com/categories/Linux/"/>
    
    
      <category term="Linux" scheme="http://www.lifayu.com/tags/Linux/"/>
    
      <category term="Update-rc.d" scheme="http://www.lifayu.com/tags/Update-rc-d/"/>
    
  </entry>
  
  <entry>
    <title>树莓派：实现物联网第一步之控制LED</title>
    <link href="http://www.lifayu.com/2019/01/10/%E6%A0%91%E8%8E%93%E6%B4%BE%EF%BC%9A%E5%AE%9E%E7%8E%B0%E7%89%A9%E8%81%94%E7%BD%91%E7%AC%AC%E4%B8%80%E6%AD%A5%E4%B9%8B%E6%8E%A7%E5%88%B6LED/"/>
    <id>http://www.lifayu.com/2019/01/10/树莓派：实现物联网第一步之控制LED/</id>
    <published>2019-01-09T19:41:51.000Z</published>
    <updated>2019-01-09T11:43:22.428Z</updated>
    
    <content type="html"><![CDATA[<p><strong>硬件部分</strong></p><p> 准备材料：</p><ul><li>树莓派</li><li>面包板（可选）</li><li>杜邦线（可选）</li><li>LED</li><li>继电器</li></ul><blockquote><p>LED、继电器等连接到面包板上，继电器连接到树莓派的GPIO11和GPIO13，LED连接到继电器，具体链接方法不再详述；<br><img src="http://z4a.net/images/2016/09/17/1da6087feb34689b.jpg" alt="硬件连接"></p></blockquote><ol><li>安装FLask(<a href="http://www.pythondoc.com/flask-mega-tutorial/helloworld.html" target="_blank" rel="noopener">Flask安装教程</a>)</li><li>创建led.py，相同目录下创建templates文件夹，里面放一个led.html，代码分别如下：<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template , request</span><br><span class="line"><span class="keyword">import</span> RPi.GPIO <span class="keyword">as</span> GPIO</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">GPIO.setmode(GPIO.BOARD)</span><br><span class="line">GPIO.setup(<span class="number">11</span>, GPIO.OUT)</span><br><span class="line">GPIO.setup(<span class="number">13</span>, GPIO.OUT)</span><br><span class="line">GPIO.setup(<span class="number">3</span>, GPIO.OUT)</span><br><span class="line">GPIO.setup(<span class="number">5</span>, GPIO.OUT)</span><br><span class="line"></span><br><span class="line">GPIO.output(<span class="number">11</span>, GPIO.HIGH)</span><br><span class="line">GPIO.output(<span class="number">13</span>, GPIO.HIGH)</span><br><span class="line">GPIO.output(<span class="number">3</span>, GPIO.LOW)</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">GPIO.output(<span class="number">3</span>, GPIO.HIGH)</span><br><span class="line">GPIO.output(<span class="number">5</span>, GPIO.LOW)</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">GPIO.output(<span class="number">5</span>, GPIO.HIGH)</span><br><span class="line">time.sleep(<span class="number">0.1</span>)</span><br><span class="line">GPIO.output(<span class="number">5</span>, GPIO.LOW)</span><br><span class="line">GPIO.output(<span class="number">3</span>, GPIO.LOW)</span><br><span class="line">GPIO.output(<span class="number">13</span>, GPIO.LOW)</span><br><span class="line">GPIO.output(<span class="number">11</span>, GPIO.LOW)</span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line">GPIO.output(<span class="number">5</span>, GPIO.HIGH)</span><br><span class="line">GPIO.output(<span class="number">3</span>, GPIO.HIGH)</span><br><span class="line">GPIO.output(<span class="number">13</span>, GPIO.HIGH)</span><br><span class="line">GPIO.output(<span class="number">11</span>, GPIO.HIGH)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">a = <span class="string">'checked'</span></span><br><span class="line"><span class="meta">@app.route('/',methods=['GET','POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> request.method ==<span class="string">'POST'</span>:</span><br><span class="line">        GPIO.output(<span class="number">5</span>, GPIO.LOW)</span><br><span class="line">        time.sleep(<span class="number">0.001</span>)</span><br><span class="line">        GPIO.output(<span class="number">5</span>, GPIO.HIGH)</span><br><span class="line">        a = request.form[<span class="string">"on2"</span>]</span><br><span class="line">        b = request.form[<span class="string">"radio"</span>]</span><br><span class="line">        <span class="keyword">if</span> b == <span class="string">'one'</span>:</span><br><span class="line">            <span class="keyword">if</span> a == <span class="string">'on'</span>:</span><br><span class="line">                GPIO.output(<span class="number">11</span>, GPIO.LOW)</span><br><span class="line">                <span class="keyword">return</span> render_template(<span class="string">'led.html'</span>,i = <span class="string">'ON'</span>,a = <span class="string">'checked'</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                GPIO.output(<span class="number">11</span>, GPIO.HIGH)</span><br><span class="line">                <span class="keyword">return</span> render_template(<span class="string">'led.html'</span>,i = <span class="string">'OFF'</span>,a = <span class="string">'checked'</span>)</span><br><span class="line">        <span class="keyword">if</span> b == <span class="string">'two'</span>:</span><br><span class="line">                <span class="keyword">if</span> a == <span class="string">'on'</span>:</span><br><span class="line">                        GPIO.output(<span class="number">13</span>, GPIO.LOW)</span><br><span class="line">                        <span class="keyword">return</span> render_template(<span class="string">'led.html'</span>,j = <span class="string">'ON'</span>,b = <span class="string">'checked'</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                        GPIO.output(<span class="number">13</span>, GPIO.HIGH)</span><br><span class="line">                        <span class="keyword">return</span> render_template(<span class="string">'led.html'</span>,j = <span class="string">'OFF'</span>,b = <span class="string">'checked'</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">'led.html'</span>,w = <span class="string">'please choose the botton!'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        GPIO.output(<span class="number">3</span>, GPIO.LOW)</span><br><span class="line">        time.sleep(<span class="number">0.1</span>)</span><br><span class="line">        GPIO.output(<span class="number">3</span>, GPIO.HIGH)</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">'led.html'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">        app.run(host=<span class="string">'0.0.0.0'</span>, port=<span class="number">8888</span>, debug=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure></li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>led开关<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"shortcut icon"</span> <span class="attr">href</span>=<span class="string">"favicon.ico"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">.aa&#123;</span></span><br><span class="line"><span class="undefined">fontcolor:FOO;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>led控制<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#123;w&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"form1"</span> <span class="attr">name</span>=<span class="string">"form1"</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">action</span>=<span class="string">""</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"radio"</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">id</span>=<span class="string">"radio"</span> <span class="attr">value</span>=<span class="string">"one"</span> &#123;&#123;<span class="attr">a</span>&#125;&#125;=<span class="string">"&#123;&#123;a&#125;&#125;"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"radio"</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">开关1   </span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"radio"</span> <span class="attr">id</span>=<span class="string">"radio"</span> <span class="attr">value</span>=<span class="string">"two"</span> &#123;&#123;<span class="attr">b</span>&#125;&#125;=<span class="string">"&#123;&#123;b&#125;&#125;"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"radio2"</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">开关2</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>状态:&#123;&#123;i&#125;&#125;     状态:&#123;&#123;j&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">style</span>=<span class="string">"width:300px; height:75px; background-color: #0F0; font-size:24px; font-family:Verdana, Geneva, sans-serif; font-weight:bold; color:#FFF"</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"on2"</span> <span class="attr">id</span>=<span class="string">"on2"</span> <span class="attr">value</span>=<span class="string">"on"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">style</span>=<span class="string">"width:300px; height:75px; background-color:#F00;font-size:24px; font-family:Verdana, Geneva, sans-serif; font-weight:bold; color:#FFF"</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"on2"</span> <span class="attr">id</span>=<span class="string">"on2"</span> <span class="attr">value</span>=<span class="string">"off"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在同一局域网中的其他手机或电脑中输入树莓派的IP地址:8888，即可看到效果：<br><img src="http://z4a.net/images/2016/09/17/IOT.png" alt="网页效果图"></p><p>最后，选择开关1或者开关2，然后点击on或者off，即可看到LED灯会点亮或熄灭。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;硬件部分&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt; 准备材料：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;树莓派&lt;/li&gt;
&lt;li&gt;面包板（可选）&lt;/li&gt;
&lt;li&gt;杜邦线（可选）&lt;/li&gt;
&lt;li&gt;LED&lt;/li&gt;
&lt;li&gt;继电器&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;

      
    
    </summary>
    
      <category term="树莓派" scheme="http://www.lifayu.com/categories/%E6%A0%91%E8%8E%93%E6%B4%BE/"/>
    
    
      <category term="树莓派" scheme="http://www.lifayu.com/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/"/>
    
      <category term="物联网" scheme="http://www.lifayu.com/tags/%E7%89%A9%E8%81%94%E7%BD%91/"/>
    
  </entry>
  
  <entry>
    <title>Git连接Coding.net远程仓库时无法push</title>
    <link href="http://www.lifayu.com/2019/01/10/Git%E8%BF%9E%E6%8E%A5Coding-net%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93%E6%97%B6%E6%97%A0%E6%B3%95push/"/>
    <id>http://www.lifayu.com/2019/01/10/Git连接Coding-net远程仓库时无法push/</id>
    <published>2019-01-09T19:40:38.000Z</published>
    <updated>2019-01-09T11:41:25.287Z</updated>
    
    <content type="html"><![CDATA[<p>树莓派上安装了Git软件，在Coding.net上创建了版本库，然后clone下来：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pi@raspberrypi:~ $ git clone git@git.coding.net:username/projectname.git</span><br></pre></td></tr></table></figure></p><p>成功clone下来，然后完成一次提交再push回去的时候却报错了，总结原因，写下我的折腾记录。。。</p><p>首先要生成ssh密钥，用命令<code>$ ssh-keygen -t rsa -C &quot;username@host.com&quot;</code>生成密钥，默认保存在<code>/home/user/.ssh</code> 目录下，包括<code>id_rsa</code>和<code>id_rsa.pub</code>两个文件，其中第一个是私钥，、第二个是公钥。<br>打开公钥，将所有内容复制，然后去coding.net的<code>我的账户-&gt;SSH公钥</code>，将复制的公钥内容粘贴进去，名称和有效日期按照自己的需求定义，最后点击添加。</p><p>然后再次push，还是报错，内容大致为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Permission denied (publickey).</span><br><span class="line">fatal: Could not read from remote repository.</span><br></pre></td></tr></table></figure></p><p>于是继续百度……发现需要把专用密钥添加到ssh-agent的高速缓存中。该命令位置在/usr/bin/ssh-add。来自: <a href="http://man.linuxde.net/ssh-add" target="_blank" rel="noopener">http://man.linuxde.net/ssh-add</a><br>于是，执行上述命令，发现又报错了：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-add ~/.ssh/rsa</span><br><span class="line">Could not open a connection to your authentication agent.</span><br></pre></td></tr></table></figure></p><p>继续搜索解决方案，最终按照以下方法解决了这个问题：<br>先执行  </p><pre><code>eval `ssh-agent` （是～键上面的那个`）</code></pre><p>再执行 <code>$ ssh-add ~/.ssh/rsa</code>成功，最后 <code>$ ssh-add -l</code> 就可以看到新加的rsa了。<br>完成如上步骤，再次尝试<code>$ git push</code>，发现终于可以推送成功了~~~</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;树莓派上安装了Git软件，在Coding.net上创建了版本库，然后clone下来：&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/sp
      
    
    </summary>
    
      <category term="Git" scheme="http://www.lifayu.com/categories/Git/"/>
    
    
      <category term="Git" scheme="http://www.lifayu.com/tags/Git/"/>
    
      <category term="Coding.net" scheme="http://www.lifayu.com/tags/Coding-net/"/>
    
  </entry>
  
  <entry>
    <title>解决树莓派软件源更新时公钥问题</title>
    <link href="http://www.lifayu.com/2019/01/10/%E8%A7%A3%E5%86%B3%E6%A0%91%E8%8E%93%E6%B4%BE%E8%BD%AF%E4%BB%B6%E6%BA%90%E6%9B%B4%E6%96%B0%E6%97%B6%E5%85%AC%E9%92%A5%E9%97%AE%E9%A2%98/"/>
    <id>http://www.lifayu.com/2019/01/10/解决树莓派软件源更新时公钥问题/</id>
    <published>2019-01-09T19:39:46.000Z</published>
    <updated>2019-01-09T11:40:22.652Z</updated>
    
    <content type="html"><![CDATA[<p>标签： 树莓派 软件源 公钥</p><hr><p>【参考链接】<br><a href="https://zhidao.baidu.com/question/137305372429911925.html" target="_blank" rel="noopener">如何更新Debian源和导入公钥</a><br><a href="https://www.cnblogs.com/arrongao/archive/2012/12/15/Hash_Sum_mismatch_key.html" target="_blank" rel="noopener">Ubuntu的软件源更新常见问题及解决</a></p><h1 id="【问题说明】"><a href="#【问题说明】" class="headerlink" title="【问题说明】"></a><strong>【问题说明】</strong></h1><p>在另一篇文章（<a href="https://www.jianshu.com/p/c8b20ff9ab6a" target="_blank" rel="noopener">树莓派安装KodExplorer变身私人云桌面</a>）中，为了安装PHP7.0(通过软件仓库安装而不是编译安装)，需要编辑文件<code>sudo vim /etc/apt/sources.list</code>，添加软件源：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deb http://mirrordirector.raspbian.org/raspbian/ stretch main contrib non-free rpi</span><br></pre></td></tr></table></figure></p><p>结果添加了软件源之后进行<code>sudo apt-get update</code>的时候报错，错误信息大致如下：</p><blockquote><p>W: GPG error: <a href="http://mirrordirector.raspbian.org/raspbian" target="_blank" rel="noopener">http://mirrordirector.raspbian.org/raspbian</a> stretch InRelease: The following signatures couldn’t be verified because the public key is not available: NO_PUBKEY 9165938D90FDDD2E<br>W: The repository ‘<a href="http://mirrordirector.raspbian.org/raspbian" target="_blank" rel="noopener">http://mirrordirector.raspbian.org/raspbian</a> stretch InRelease’ is not signed.<br>N: Data from such a repository can’t be authenticated and is therefore potentially dangerous to use.<br>N: See apt-secure(8) manpage for repository creation and user configuration details.<br>W: There is no public key available for the following key IDs:<br>9165938D90FDDD2E<br>E: Failed to fetch <a href="http://mirrordirector.raspbian.org/raspbian/dists/stretch/main/binary-armhf/Packages.xz" target="_blank" rel="noopener">http://mirrordirector.raspbian.org/raspbian/dists/stretch/main/binary-armhf/Packages.xz</a>  Hash Sum mismatch<br>E: Some index files failed to download. They have been ignored, or old ones used instead.</p></blockquote><p>错误信息大致意思为没有找到对应的公钥，所以软件源地址不被信任。</p><h1 id="【解决方案】"><a href="#【解决方案】" class="headerlink" title="【解决方案】"></a><strong>【解决方案】</strong></h1><p>解决方案就是导入对应仓库的公钥，命令格式为:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --keyserver &lt;KeyServer&gt; --recv &lt;公钥签名&gt; gpg --export --armor &lt;公钥签名&gt; | sudo apt-key add</span><br></pre></td></tr></table></figure></p><p>也可以用如下格式：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-key adv --keyserver &lt;KeyServer&gt; --recv-keys &lt;公钥签名&gt;</span><br><span class="line">gpg --export --armor 40976EAF437D05B5 | sudo apt-key add -</span><br></pre></td></tr></table></figure></p><p>其中：<br><code>&lt;KeyServer&gt;</code>，key服务器，可以填 <code>keyserver.ubuntu.com</code> ，当然也可以填其他的。<br>在本例中，按照上面的格式，执行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gpg --keyserver  keyserver.ubuntu.com --recv-keys 9165938D90FDDD2E</span><br><span class="line">gpg --export --armor  9165938D90FDDD2E | sudo apt-key add -</span><br></pre></td></tr></table></figure></p><p>然后再执行<code>sudo apt-get update</code>即可解决问题。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;标签： 树莓派 软件源 公钥&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;【参考链接】&lt;br&gt;&lt;a href=&quot;https://zhidao.baidu.com/question/137305372429911925.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;如
      
    
    </summary>
    
      <category term="树莓派" scheme="http://www.lifayu.com/categories/%E6%A0%91%E8%8E%93%E6%B4%BE/"/>
    
    
      <category term="树莓派" scheme="http://www.lifayu.com/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/"/>
    
      <category term="软件源" scheme="http://www.lifayu.com/tags/%E8%BD%AF%E4%BB%B6%E6%BA%90/"/>
    
      <category term="公钥" scheme="http://www.lifayu.com/tags/%E5%85%AC%E9%92%A5/"/>
    
  </entry>
  
  <entry>
    <title>A Quick Guide to Using the MySQL APT Repository</title>
    <link href="http://www.lifayu.com/2019/01/10/A-Quick-Guide-to-Using-the-MySQL-APT-Repository/"/>
    <id>http://www.lifayu.com/2019/01/10/A-Quick-Guide-to-Using-the-MySQL-APT-Repository/</id>
    <published>2019-01-09T19:38:15.000Z</published>
    <updated>2019-01-09T11:39:29.949Z</updated>
    
    <content type="html"><![CDATA[<p>标签： MySQL APT Repository</p><hr><p>【来自：<a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/】" target="_blank" rel="noopener">https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/】</a></p><p><strong>Abstract</strong></p><p>This is a quick guide to using the MySQL APT repository, which provides <code>deb</code> packages for installing and managing the MySQL server, client, and other components on the following Linux platforms:</p><ul><li><p>Debian 7.x (“Wheezy”)</p></li><li><p>Debian 8.x (“Jessie”)</p></li><li><p>Debian 9.x (“Stretch”)</p></li><li><p>Ubuntu 14.04 LTS (“Trusty Tahr”)</p></li><li><p>Ubuntu 16.04 (“Xenial Xerus”)</p></li><li><p>Ubuntu 17.04 (“Zesty Zapu”)</p></li><li><p>Ubuntu 17.10 (“Artful Aardvark”)</p></li></ul><p>For legal information, see the <a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#legalnotice" target="_blank" rel="noopener">Legal Notices</a>.</p><p>For help with using MySQL, please visit either the <a href="http://forums.mysql.com/" target="_blank" rel="noopener">MySQL Forums</a> or <a href="http://lists.mysql.com/" target="_blank" rel="noopener">MySQL Mailing Lists</a>, where you can discuss your issues with other MySQL users.</p><p>For additional documentation on MySQL products, including translations of the documentation into other languages, and downloadable versions in variety of formats, including HTML and PDF formats, see the <a href="http://dev.mysql.com/doc" target="_blank" rel="noopener">MySQL Documentation Library</a>.</p><p>Document generated on: 2018-01-06 (revision: 55374)</p><hr><p><strong>Table of Contents</strong></p><hr><ol><li><p><a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#apt-repo-fresh-install" target="_blank" rel="noopener">Steps for a Fresh Installation of MySQL</a></p></li><li><p><a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-select-series" target="_blank" rel="noopener">Selecting a Major Release Version</a></p></li><li><p><a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#apt-repo-install-components" target="_blank" rel="noopener">Installing Additional MySQL Products and Components with APT</a></p></li><li><p><a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qp-apt-install-from-source" target="_blank" rel="noopener">Installing MySQL from Source with the MySQL APT Repository</a></p></li><li><p><a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-upgrading" target="_blank" rel="noopener">Upgrading MySQL with the MySQL APT Repository</a></p></li><li><p><a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-replacing" target="_blank" rel="noopener">Replacing a Native Distribution of MySQL Using the MySQL APT Repository</a></p></li><li><p><a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-replace-direct" target="_blank" rel="noopener">Replacing a MySQL Server Installed by a Direct deb Package Download</a></p></li><li><p><a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#apt-repo-remove" target="_blank" rel="noopener">Removing MySQL with APT</a></p></li><li><p><a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#updating-apt-repo-client-lib" target="_blank" rel="noopener">Special Notes on Upgrading the Shared Client Libraries</a></p></li><li><p><a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-cluster-install" target="_blank" rel="noopener">Installing MySQL NDB Cluster Using the APT Repository</a></p></li><li><p><a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#apt-repo-install-cluster-components" target="_blank" rel="noopener">Installing Additional MySQL NDB Cluster Products and Components</a></p></li><li><p><a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-available" target="_blank" rel="noopener">Available Packages from the MySQL APT Repository</a></p></li><li><p><a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-repo-manual-setup" target="_blank" rel="noopener">Appendix A: Adding and Configuring the MySQL APT Repository Manually</a></p></li><li><p><a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-repo-non-insteractive" target="_blank" rel="noopener">Appendix B: Installing MySQL Non-interactively with MySQL APT Repository</a></p></li><li><p><a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-repo-errors-sources-list" target="_blank" rel="noopener">Appendix C: Errors with Missing Entries in the Repository Sources List</a></p></li></ol><p><strong>Steps for a Fresh Installation of MySQL</strong></p><blockquote><p><strong>Note</strong><br>The following instructions assume that no versions of MySQL (whether distributed by Oracle or other parties) have already been installed on your system; if that is not the case, follow the instructions given in <a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-replacing" target="_blank" rel="noopener">Replacing a Native Distribution of MySQL Using the MySQL APT Repository</a> or <a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-replace-direct" target="_blank" rel="noopener">Replacing a MySQL Server Installed by a Direct deb Package Download</a> instead.</p></blockquote><h1 id="1-Adding-the-MySQL-APT-Repository"><a href="#1-Adding-the-MySQL-APT-Repository" class="headerlink" title="1.Adding the MySQL APT Repository"></a>1.Adding the MySQL APT Repository</h1><p>First, add the MySQL APT repository to your system’s software repository list. Follow these steps:</p><ol><li><p>Go to the download page for the MySQL APT repository at <a href="http://dev.mysql.com/downloads/repo/apt/" target="_blank" rel="noopener">http://dev.mysql.com/downloads/repo/apt/</a>.</p></li><li><p>Select and download the release package for your Linux distribution.</p></li><li><p>Install the downloaded release package with the following command, replacing <strong><em>version-specific-package-name</em></strong> with the name of the downloaded package (preceded by its path, if you are not running the command inside the folder where the package is):</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo dpkg -i /PATH/version-specific-package-name.deb</span><br></pre></td></tr></table></figure></li></ol><p>For example, for version <strong><em>w.x.y-z</em></strong> of the package, the command is:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo dpkg -i mysql-apt-config_w.x.y-z_all.deb</span><br></pre></td></tr></table></figure></p><p>Note that the same package works on all supported Debian and Ubuntu platforms.</p><ol start="4"><li>During the installation of the package, you will be asked to choose the versions of the MySQL server and other components (for example, the MySQL Workbench) that you want to install. If you are not sure which version to choose, do not change the default options selected for you. You can also choose <strong>none</strong> if you do not want a particular component to be installed. After making the choices for all components, choose <strong>Ok</strong> to finish the configuration and installation of the release package.</li></ol><p>You can always change your choices for the versions later; see <a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-select-series" target="_blank" rel="noopener">Selecting a Major Release Version</a> for instructions.</p><ol start="5"><li>Update package information from the MySQL APT repository with the following command (<em>this step is mandatory</em>):<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo apt-get update</span><br></pre></td></tr></table></figure></li></ol><p>Instead of using the release package, you can also add and configure the MySQL APT repository manually; see <a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-repo-manual-setup" target="_blank" rel="noopener">Appendix A: Adding and Configuring the MySQL APT Repository Manually</a> for details.</p><blockquote><p><strong>Note</strong><br>Once the MySQL APT repository is enabled on your system, you will no longer be able to install any MySQL packages from your platform’s native software repositories until the MySQL APT repository is disabled.</p></blockquote><p>#2.Installing MySQL with APT<br>Install MySQL by the following command:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo apt-get install mysql-server</span><br></pre></td></tr></table></figure></p><p>This installs the package for the MySQL server, as well as the packages for the client and for the database common files.</p><p>During the installation, you are asked to supply a password for the root user for your MySQL installation.</p><blockquote><p><strong>Important</strong><br>Make sure you remember the root password you set. Users who want to set a password later can leave the <strong>password</strong> field blank in the dialogue box and just press <strong>Ok</strong>; in that case, root access to the server will be authenticated by <a href="https://dev.mysql.com/doc/refman/5.7/en/socket-pluggable-authentication.html" target="_blank" rel="noopener">Socket Peer-Credential Pluggable Authentication</a> for connections using a Unix socket file. You can set the root password later using the program <a href="https://dev.mysql.com/doc/refman/5.7/en/mysql-secure-installation.html" target="_blank" rel="noopener"><strong>mysql_secure_installation</strong></a>.</p></blockquote><p>#3.Starting and Stopping the MySQL Server<br>The MySQL server is started automatically after installation. You can check the status of the MySQL server with the following command:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo service mysql status</span><br></pre></td></tr></table></figure></p><p>Stop the MySQL server with the following command:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo service mysql stop</span><br></pre></td></tr></table></figure></p><p>To restart the MySQL server, use the following command:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo service mysql start</span><br></pre></td></tr></table></figure></p><blockquote><p><strong>Note</strong><br>A few third-party native repository packages that have dependencies on the native MySQL packages may not work with the MySQL APT repository packages and should not be used together with them; these include akonadi-backend-mysql, handlersocket-mysql-5.5, and zoneminder.</p></blockquote><p><strong>Selecting a Major Release Version</strong><br>By default, all installations and upgrades for your MySQL server and the other required components come from the release series of the major version you have selected during the installation of the configuration package (see <a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#apt-repo-setup" target="_blank" rel="noopener">Adding the MySQL APT Repository</a>). However, you can switch to another supported major release series at any time by reconfiguring the configuration package you have installed. Use the following command:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo dpkg-reconfigure mysql-apt-config</span><br></pre></td></tr></table></figure></p><p>A dialogue box then asks you to choose the major release version you want. Make your selection and choose <strong>Ok</strong>. After returning to the command prompt, update package information from the MySQL APT repository with this command:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo apt-get update</span><br></pre></td></tr></table></figure></p><p>The latest version in the selected series will then be installed when you use the <strong>apt-get install</strong> command next time.</p><p>You can use the same method to change the version for any other MySQL component you want to install with the MySQL APT repository.</p><p><strong>Installing Additional MySQL Products and Components</strong><br>You can use APT to install individual components of MySQL from the MySQL APT repository. Assuming you already have the MySQL APT repository on your system’s repository list (see <a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#apt-repo-setup" target="_blank" rel="noopener">Adding the MySQL APT Repository for instructions</a>), first, use the following command to get the latest package information from the MySQL APT repository:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo apt-get update</span><br></pre></td></tr></table></figure></p><p>Install any packages of your choice with the following command, replacing <strong><em>package-name</em></strong> with name of the package (<a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-available" target="_blank" rel="noopener">here</a> is a list of available packages):<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo apt-get install package-name</span><br></pre></td></tr></table></figure></p><p>For example, to install the MySQL Workbench:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo apt-get install mysql-workbench-community</span><br></pre></td></tr></table></figure></p><p>To install the shared client libraries:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo apt-get install libmysqlclient18</span><br></pre></td></tr></table></figure></p><p><strong>Installing MySQL from Source with the MySQL APT Repository</strong></p><blockquote><p><strong>Note</strong><br>This feature is only supported on 64-bit systems.</p></blockquote><p>You can download the source code for MySQL and build it using the MySQL APT Repository:</p><ol><li><p>Add the MySQL APT repository to your system’s repository list and choose the major release series you want (see <a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#apt-repo-setup" target="_blank" rel="noopener">Adding the MySQL APT Repository</a> for instructions).</p></li><li><p>Update package information from the MySQL APT repository with the following command (<em>this step is mandatory</em>):</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo apt-get update</span><br></pre></td></tr></table></figure></li><li><p>Install packages that the build process depends on:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo apt-get build-dep mysql-server</span><br></pre></td></tr></table></figure></li><li><p>Download the source code for the major components of MySQL and then build them (run this command in the folder in which you want the downloaded files and the builds to be located):</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; apt-get source -b mysql-server</span><br></pre></td></tr></table></figure></li></ol><p><code>deb</code> packages for installing the various MySQL components are created.</p><ol start="5"><li>Pick the <code>deb</code> packages for the MySQL components you need and install them with the command:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo dpkg -i package-name.deb</span><br></pre></td></tr></table></figure></li></ol><p>Notice that dependency relationships exist among the MySQL packages. For a basic installation of the MySQL server, install the database common files package, the client package, the client metapackage, the server package, and the server metapackage (in that order) with the following steps:</p><ul><li>Preconfigure the MySQL server package with the following command:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo dpkg-preconfigure mysql-community-server_version-and-platform-specific-part.deb</span><br></pre></td></tr></table></figure></li></ul><p>You will be asked to provide a password for the root user for your MySQL installation; see important information on root password given in <a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-installing" target="_blank" rel="noopener">Installing MySQL with APT</a> above. You might also be asked other questions regarding the installation.</p><ul><li><p>Install the required packages with a single command:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo dpkg -i mysql-&#123;common,community-client,client,community-server,server&#125;_*.deb</span><br></pre></td></tr></table></figure></li><li><p>If you are being warned of unmet dependencies by <strong>dpkg</strong>, you can fix them using <strong>apt-get</strong>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get -f install</span><br></pre></td></tr></table></figure></li></ul><p>Here are where the files are installed on the system:</p><ul><li><p>All configuration files (like <code>my.cnf</code>) are under <code>/etc/mysql</code></p></li><li><p>All binaries, libraries, headers, etc., are under <code>/usr/bin</code> and <code>/usr/sbin</code></p></li><li><p>The data directory is under <code>/var/lib/mysql</code></p></li></ul><p>See also information given in <a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-starting-and-stopping-server" target="_blank" rel="noopener">Starting and Stopping the MySQL Server</a>.</p><p><strong>Upgrading MySQL with the MySQL APT Repository</strong></p><blockquote><p><strong>Notes</strong></p></blockquote><blockquote><ul><li>Before performing any upgrade to MySQL, follow carefully the instructions in <a href="https://dev.mysql.com/doc/refman/5.7/en/upgrading.html" target="_blank" rel="noopener">Upgrading MySQL</a>. Among other instructions discussed there, <strong><em>it is especially important to back up your database before the upgrade</em></strong>.</li></ul></blockquote><blockquote><ul><li>The following instructions assume that MySQL has been installed on your system using the MySQL APT repository; if that is not the case, follow the instructions given in <a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-replacing" target="_blank" rel="noopener">Replacing a Native Distribution of MySQL Using the MySQL APT Repository</a> or <a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-replace-direct" target="_blank" rel="noopener">Replacing a MySQL Server Installed by a Direct deb Package Download</a> instead. Also notice that you cannot use the MySQL APT repository to upgrade a distribution of MySQL that you have installed from a nonnative software repository (for example, from MariaDB or Percona).</li></ul></blockquote><p>Use the MySQL APT repository to perform an in-place upgrade for your MySQL installation (that is, replacing the old version and then running the new version off the old data files) by following these steps:</p><ol><li><p>Make sure you already have the MySQL APT repository on your system’s repository list (see <a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#apt-repo-setup" target="_blank" rel="noopener">Adding the MySQL APT Repository</a> for instructions).</p></li><li><p>Make sure you have the most up-to-date package information on the MySQL APT repository by running:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo apt-get update</span><br></pre></td></tr></table></figure></li><li><p>Note that, by default, the MySQL APT repository will update MySQL to the release series you have selected when you were <a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-select-series" target="_blank" rel="noopener">adding the MySQL APT repository to your system</a>. If you want to upgrade to another release series, select it by following the steps given in <a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-select-series" target="_blank" rel="noopener">Selecting a Major Release Version</a>.</p></li></ol><p>As a general rule, to upgrade from one release series to another, go to the next series rather than skipping a series. For example, if you are currently running MySQL 5.5 and wish to upgrade to a newer series, upgrade to MySQL 5.6 first before upgrading to 5.7, and so on.</p><blockquote><p><strong>Important</strong></p></blockquote><blockquote><ul><li>For important information about upgrading from MySQL 5.5 to 5.6, see U<a href="https://dev.mysql.com/doc/refman/5.6/en/upgrading-from-previous-series.html" target="_blank" rel="noopener">pgrading from MySQL 5.5 to 5.6</a>.</li></ul></blockquote><blockquote><ul><li>For important information about upgrading from MySQL 5.6 to 5.7, see <a href="https://dev.mysql.com/doc/refman/5.7/en/upgrading-from-previous-series.html" target="_blank" rel="noopener">Upgrading from MySQL 5.6 to 5.7</a>.</li></ul></blockquote><blockquote><ul><li>For important information about upgrading from MySQL 5.7 to 8.0, see <a href="https://dev.mysql.com/doc/refman/8.0/en/upgrading-from-previous-series.html" target="_blank" rel="noopener">Upgrading from MySQL 5.7 to 8.0</a>.</li></ul></blockquote><blockquote><ul><li>In-place downgrading of MySQL is not supported by the MySQL APT repository. Follow the instructions in <a href="https://dev.mysql.com/doc/refman/5.7/en/downgrading.html" target="_blank" rel="noopener">Downgrading MySQL</a>.</li></ul></blockquote><ol start="4"><li>Upgrade MySQL by the following command:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo apt-get install mysql-server</span><br></pre></td></tr></table></figure></li></ol><p>The MySQL server, client, and the database common files are upgraded if newer versions are available. To upgrade any other MySQL package, use the same <strong>apt-get install</strong> command and supply the name for the package you want to upgrade:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; sudo apt-get install package-name</span><br></pre></td></tr></table></figure></p><p>To see the names of the packages you have installed from the MySQL APT repository, use the following command:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; dpkg -l | grep mysql | grep ii</span><br></pre></td></tr></table></figure></p><blockquote><p><strong>Note</strong><br>If you perform a system-wide upgrade by the <strong>apt-get upgrade</strong>, only the library and development packages for MySQL will get upgraded with newer versions (if available). To upgrade other components including the server, client, test suite, etc., use the <strong>apt-get install</strong> command, as explained precedingly.</p></blockquote><ol start="5"><li>The MySQL server always restarts after an update by APT. Once the server restarts, you should run <strong>mysql_upgrade</strong> to check and possibly resolve any incompatibilities between the old data and the upgraded software. <strong>mysql_upgrade</strong> also performs other functions; see <a href="https://dev.mysql.com/doc/refman/5.7/en/mysql-upgrade.html" target="_blank" rel="noopener"><strong>mysql_upgrade</strong> — Check and Upgrade MySQL Tables</a> for details.</li></ol><p><strong>Replacing a Native Distribution of MySQL Using the MySQL APT Repository</strong><br>Variants and forks of MySQL are distributed by different parties through their own software repositories or download sites. You can replace a native distribution of MySQL installed from your Linux platform’s software repository with a distribution from the MySQL APT repository in a few steps.</p><blockquote><p><strong>Note</strong><br>The MySQL APT repository can only replace distributions of MySQL maintained and distributed by Debian or Ubuntu. It cannot replace any MySQL forks found either inside or outside of the distributions’ native repositories. To replace such MySQL forks, you have to uninstall them first before you install MySQL using the MySQL APT repository. Follow the instructions for uninstallation from the forks’ distributors and, before you proceed, make sure you back up your data and you know how to restore them to a new server.</p></blockquote><blockquote><p><strong>Warning</strong><br>A few third-party native repository packages that have dependencies on the native MySQL packages may not work with the MySQL APT repository packages and should not be used together with them; these include akonadi-backend-mysql, handlersocket-mysql-5.5, and zoneminder.</p></blockquote><p><strong>1.Backing Up Your Database</strong><br>To avoid loss of data, always back up your database before trying to replace your MySQL installation using the MySQL APT repository. See Backup and Recovery for instructions.</p><p><strong>2.Adding the MySQL APT Repository and Selecting a Release Series</strong><br>Add the MySQL APT repository to your system’s repository list and select the release series you want by following the instructions given in <a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#apt-repo-setup" target="_blank" rel="noopener">Adding the MySQL APT Repository</a>.</p><p><strong>3.Replacing the Native Distribution by an APT Update</strong><br>By design, the MySQL APT repository replaces your native distribution of MySQL when you perform upgrades on the MySQL packages. To perform the upgrades, follow the same instructions given in <a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#apt-repo-upgrade-step4" target="_blank" rel="noopener">Step 4</a> in <a href="https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/index.html#repo-qg-apt-upgrading" target="_blank" rel="noopener">Upgrading MySQL with the MySQL APT Repository</a>.</p><blockquote><p><strong>Warning</strong><br>Once the native distribution of MySQL has been replaced using the MySQL APT repository, purging the old MySQL packages from the native repository using the <strong>apt-get purge, apt-get remove –purge</strong>, or <strong>dpkg -P</strong> command might impact the newly installed MySQL server in various ways. Therefore, <em>do not purge the old MySQL packages from the native repository packages</em>.</p></blockquote><p><strong>Replacing a MySQL Server Installed by a Direct deb Package Download</strong><br><code>deb</code> packages from MySQL for installing the MySQL server and its components can either be downloaded from the MySQL Developer Zone’s MySQL Download page or from the MySQL APT repository. The deb packages from the two sources are different, and they install and configure MySQL in different ways.</p><p>If you have installed MySQL with the MySQL Developer Zone’s deb packages and now want to replace the installation using the ones from the MySQL APT repository, follow these steps:</p><p>Back up your database. See Backup and Recovery for instructions.</p><p>Follow the steps given previously for adding the MySQL APT repository.</p><p>Remove the old installation of MySQL by running:</p><p>shell&gt; sudo dpkg -P mysql<br>Install MySQL from the MySQL APT repository:</p><p>shell&gt; sudo apt-get install mysql-server<br>If needed, restore the data on the new MySQL installation. See Backup and Recovery for instructions.</p><p>Removing MySQL with APT<br>To uninstall the MySQL server and the related components that have been installed using the MySQL APT repository, first, remove the MySQL server using the following command:</p><p>shell&gt; sudo apt-get remove mysql-server<br>Then, remove any other software that was installed automatically with the MySQL server:</p><p>shell&gt; sudo apt-get autoremove<br>To uninstall other components, use the following command, replacing package-name with the name of the package of the component you want to remove:</p><p>shell&gt; sudo apt-get remove package-name<br>To see a list of packages you have installed from the MySQL APT repository, use the following command:</p><p>shell&gt; dpkg -l | grep mysql | grep ii<br>Special Notes on Upgrading the Shared Client Libraries<br>You can install the shared client libraries from MySQL APT repository by the following command (see Installing Additional MySQL Products and Components with APT for more details):</p><p>shell&gt; sudo apt-get install libmysqlclient20<br>If you already have the shared client libraries installed from you Linux platform’s software repository, it can be updated by the MySQL APT repository with its own package by using the same command (see Replacing the Native Distribution by an APT Update for more details).</p><p>After updating MySQL using the APT repository, applications compiled with older versions of the shared client libraries should continue to work.</p><p>If you recompile applications and dynamically link them with the updated libraries: as typical with new versions of shared libraries, any applications compiled using the updated, newer shared libraries might require those updated libraries on systems where the applications are deployed. If those libraries are not in place, the applications requiring the shared libraries might fail. Therefore, it is recommended that the packages for the shared libraries from MySQL be deployed on those systems. You can do this by adding the MySQL APT repository to the systems (see Adding the MySQL APT Repository) and installing the latest shared client libraries using the command given at the beginning of this section.</p><p>Installing MySQL NDB Cluster Using the APT Repository<br>Notes<br>The MySQL APT repository supports installation of MySQL NDB Cluster only for release 7.5.6 and later, and only for Debian 7.x and 8.x, and Ubuntu 14.04 and 16.04. For other methods of installing NDB Cluster, see Installation of NDB Cluster on Linux, or Installation of NDB Cluster on Linux, depending on the release series that you are using.</p><p>If you already have the MySQL server or MySQL NDB Cluster installed on your system, make sure it is stopped and you have your data and configuration files backed up before proceeding.</p><p>Known issues: The MySQL NDB Cluster packages have dependencies on the python-paramiko and libclass-methodmaker-perl packages, which are currently NOT installed automatically when you install the NDB Cluster packages; install those required packages yourself with this command before installing the NDB Cluster packages:</p><p>shell&gt; sudo apt-get install python-paramiko libclass-methodmaker-perl<br>Adding the MySQL APT Repository for MySQL NDB Cluster<br>Follow the steps in Adding the MySQL APT Repository to add the MySQL APT repository to your system’s repository list. During the installation process of the configuration package, when you are asked which MySQL product you want to configure, choose “MySQL Server &amp; Cluster”; when asked which version you wish to receive, choose “mysql-cluster-x.y.” After returning to the command prompt, go to Step 2 below.</p><p>If you already have the configuration package installed on your system, make sure it is up-to-date by running the following command:</p><p>shell&gt; sudo apt-get install mysql-apt-config<br>Then, use the same method described in Selecting a Major Release Version to select MySQL NDB Cluster for installation. When you are asked which MySQL product you want to configure, choose “MySQL Server &amp; Cluster”; when asked which version you wish to receive, choose “mysql-cluster-x.y.” After returning to the command prompt, update package information from the MySQL APT repository with this command:</p><p>shell&gt; sudo apt-get update<br>Installing MySQL NDB Cluster<br>For a minimal installation of MySQL NDB Cluster, follow these steps:</p><p>Install the components for SQL nodes:</p><p>shell&gt; sudo apt-get install mysql-cluster-community-server<br>You will be asked to provide a password for the root user for your SQL node; see important information on the root password given in Installing MySQL with APT above. You might also be asked other questions regarding the installation.</p><p>Install the executables for management nodes:</p><p>shell&gt; sudo apt-get install mysql-cluster-community-management-server<br>Install the executables for data nodes:</p><p>shell&gt; sudo apt-get install mysql-cluster-community-data-node<br>Configuring and Starting MySQL NDB Cluster<br>See Initial Configuration of NDB Cluster on how to configure MySQL NDB Cluster and Initial Startup of NDB Cluster on how to start it for the first time. When following those instructions, adjust them according to the following details regarding the SQL nodes of your NDB Cluster installation:</p><p>All configuration files (like my.cnf) are under /etc/mysql</p><p>All binaries, libraries, headers, etc., are under /usr/bin and /usr/sbin</p><p>The data directory is /var/lib/mysql</p><p>Installing Additional MySQL NDB Cluster Products and Components<br>You can use APT to install individual components and additional products of MySQL NDB Cluster from the MySQL APT repository (see Available Packages from the MySQL APT Repository for a list). To do that, assuming you already have the MySQL APT repository on your system’s repository list (see Adding the MySQL Yum Repository for MySQL NDB Cluster), follow the same steps given in Installing Additional MySQL Products and Components with APT.</p><p>Note<br>Known issue: Currently, not all components required for running the MySQL NDB Cluster test suite are installed automatically when you install the test suite package (mysql-cluster-community-test). Install the following packages with apt-get install before you run the test suite:</p><p>mysql-cluster-community-auto-installer</p><p>mysql-cluster-community-management-server</p><p>mysql-cluster-community-data-node</p><p>mysql-cluster-community-memcached</p><p>mysql-cluster-community-java</p><p>ndbclient-dev</p><p>Available Packages from the MySQL APT Repository<br>Table 1 Available Packages from the MySQL APT Repository</p><p>Package Name    Description<br>mysql-server</p><p>Metapackage for installing the MySQL server</p><p>mysql-community-server</p><p>MySQL server</p><p>mysql-client</p><p>Metapackage for installing the MySQL client</p><p>mysql-cluster-community-auto-installer</p><p>Auto installer for NDB Cluster</p><p>mysql-cluster-community-client</p><p>MySQL client for NDB Cluster</p><p>mysql-cluster-community-data-node</p><p>NDB Cluster data node</p><p>mysql-cluster-community-java</p><p>NDB Cluster Java drivers</p><p>mysql-cluster-community-management-server</p><p>NDB Cluster management node</p><p>mysql-cluster-community-memcached</p><p>NDB Cluster memcached server</p><p>mysql-cluster-community-server</p><p>MySQL server for NDB Cluster</p><p>mysql-cluster-community-source</p><p>Source package for NDB Cluster</p><p>mysql-cluster-community-test</p><p>NDB Cluster testsuite</p><p>mysql-community-client</p><p>MySQL client</p><p>mysql-common</p><p>MySQL database common files</p><p>libmysqlclient20</p><p>MySQL database client library</p><p>libmysqlclient-dev</p><p>MySQL database development files</p><p>libmysqld-dev</p><p>MySQL embedded database development files</p><p>mysql-testsuite</p><p>Metapackage for installing the MySQL test suite</p><p>mysql-community-test</p><p>MySQL test suite</p><p>mysql-community-bench</p><p>MySQL benchmark suite</p><p>mysql-community-source</p><p>MySQL source code</p><p>mysql-workbench-community<br>MySQL Workbench (not available for Debian platforms)</p><p>mysql-connector-python-py3<br>MySQL Connector/Python for Ubuntu 14.04, 14.10, and 15.04 with Python 3.2 or later</p><p>mysql-connector-python<br>MySQL Connector/Python for Debian 7.x or Debian 8.x with Python 2.6.3 or later, and for Ubuntu 14.04, 14.10, or 15.04 with Python 2.6.3 to 3.1</p><p>mysql-utilities    MySQL Utilities (currently not available for Debian 8.x)<br>mysql-router    MySQL Router<br>ndbclient    NDB Cluster client<br>ndbclient-dev    NDB Cluster client development library</p><p>Appendix A: Adding and Configuring the MySQL APT Repository Manually<br>Here are the steps for adding manually the MySQL APT repository to your system’s software repository list and configuring it, without using the release packages provided by MySQL:</p><p>Download the MySQL GPG Public key (see Signature Checking Using GnuPG on how to do that) and save it to a file, without adding any spaces or special characters. Then, add the key to your system’s GPG keyring with the following command:</p><p>shell&gt; sudo apt-key add path/to/signature-file<br>Alternatively, you can download the GPG key to your APT keyring directly using the apt-key utility:</p><p>shell&gt; sudo apt-key adv –keyserver pgp.mit.edu –recv-keys 5072E1F5<br>Create a file named /etc/apt/sources.list.d/mysql.list, and put into it repository entries in the following format:</p><p>deb <a href="http://repo.mysql.com/apt/{debian|ubuntu}/" target="_blank" rel="noopener">http://repo.mysql.com/apt/{debian|ubuntu}/</a> {jessie|wheezy|trusty|utopic|vivid} {mysql-5.6|mysql-5.7|workbench-6.2|utilities-1.4|connector-python-2.0}<br>Pick the relevant options for your repository set up:</p><p>Choose “debian” or “ubuntu” according to whether you are on a Debian or Ubuntu platform.</p><p>Choose “jessie,” “ wheezy,” “trusty,” “utopic,” or “vivid,” according to the version of your operating system.</p><p>For installing MySQL server, client, and database common files, choose “mysql-5.6” or “mysql-5.7” according to the MySQL version you want. To switch to another release series later, come back and adjust the entry with your new choice.</p><p>Note<br>If you already have a version of MySQL installed on your system, do not choose a lower version at this step, or it might result in an unsupported downgrade operation.</p><p>For installing components like MySQL Workbench, MySQL Utilities, or MySQL Connector Python, create a single entry for each of them, specifying respectively “workbench-6.2,” “utilities-1.4,” or “connector-python-2.0” at the end of each entry.</p><p>As an example, for a Ubuntu 14.04 platform, here are the lines in your mysql.list files for installing MySQL 5.6 and MySQL Connector/Python from the MySQL APT repository:</p><p>deb <a href="http://repo.mysql.com/apt/ubuntu/" target="_blank" rel="noopener">http://repo.mysql.com/apt/ubuntu/</a> trusty mysql-5.6<br>deb <a href="http://repo.mysql.com/apt/ubuntu/" target="_blank" rel="noopener">http://repo.mysql.com/apt/ubuntu/</a> trusty connector-python-2.0<br>Use the following command to get the most up-to-date package information from the MySQL APT repository:</p><p>shell&gt; sudo apt-get update<br>You have configured your system to use the MySQL APT repository and are now ready to continue with Installing MySQL with APT or Installing Additional MySQL Products and Components with APT.</p><p>Appendix B: Installing MySQL Non-interactively with MySQL APT Repository<br>For non-interactive installations of MySQL with the MySQL APT repository, answer the interactive questions asked by the server package by setting the relevant debconf variables in, for example, your installation script. These are the variables to set:</p><p>root_password: This is the root password for the server installation.</p><p>root_password_again: This is the root password, entered a second time for confirmation.</p><p>The following are steps from a sample script that set the debconf variables and then install MySQL non-interactively by setting the environment variable DEBIAN_FRONTEND to noninteractive:</p><p>sudo debconf-set-selections &lt;&lt;&lt; “mysql-community-server mysql-community-server/root-pass password mypassword”<br>sudo debconf-set-selections &lt;&lt;&lt; “mysql-community-server mysql-community-server/re-root-pass password mypassword”<br>sudo DEBIAN_FRONTEND=noninteractive apt-get -y install mysql-server<br>The password variables are erased automatically after MySQL has been installed, so they need to be set again if the installation is to be repeated.</p><p>Appendix C: Errors with Missing Entries in the Repository Sources List<br>Users who configured their systems some time ago with an early and now outdated version of the release package for the MySQL APT repository might see a warning similar to the one below when running the apt-get update command:</p><p>shell&gt; sudo apt-get update<br>W: Failed to fetch <a href="http://repo.mysql.com/apt/ubuntu/dists/trusty/InRelease" target="_blank" rel="noopener">http://repo.mysql.com/apt/ubuntu/dists/trusty/InRelease</a><br>Unable to find expected entry ‘utilities-1.4/binary-amd64/Packages’ in<br>Release file (Wrong sources.list entry or malformed file)<br>The apt-get update command fails with this, and it is no longer possible to update package information for the MySQL APT repository. This is due to outdated entries in the sources list, and you can resolve the problem by the following steps:</p><p>Delete the file /etc/apt/sources.list.d/mysql.list from your system. That removes all sources list entries for the MySQL APT repository.</p><p>Download and install the latest version of the release package for the MySQL repository by following the steps given in Adding the MySQL APT Repository, including the sudo apt-get update step. It reconfigures your system properly for using the MySQL APT repository.</p><p>Legal Notices<br>Copyright © 1997, 2018, Oracle and/or its affiliates. All rights reserved.</p><p>This software and related documentation are provided under a license agreement containing restrictions on use and disclosure and are protected by intellectual property laws. Except as expressly permitted in your license agreement or allowed by law, you may not use, copy, reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish, or display any part, in any form, or by any means. Reverse engineering, disassembly, or decompilation of this software, unless required by law for interoperability, is prohibited.</p><p>The information contained herein is subject to change without notice and is not warranted to be error-free. If you find any errors, please report them to us in writing.</p><p>If this is software or related documentation that is delivered to the U.S. Government or anyone licensing it on behalf of the U.S. Government, then the following notice is applicable:</p><p>U.S. GOVERNMENT END USERS: Oracle programs, including any operating system, integrated software, any programs installed on the hardware, and/or documentation, delivered to U.S. Government end users are “commercial computer software” pursuant to the applicable Federal Acquisition Regulation and agency-specific supplemental regulations. As such, use, duplication, disclosure, modification, and adaptation of the programs, including any operating system, integrated software, any programs installed on the hardware, and/or documentation, shall be subject to license terms and license restrictions applicable to the programs. No other rights are granted to the U.S. Government.</p><p>This software or hardware is developed for general use in a variety of information management applications. It is not developed or intended for use in any inherently dangerous applications, including applications that may create a risk of personal injury. If you use this software or hardware in dangerous applications, then you shall be responsible to take all appropriate fail-safe, backup, redundancy, and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any damages caused by use of this software or hardware in dangerous applications.</p><p>Oracle and Java are registered trademarks of Oracle and/or its affiliates. Other names may be trademarks of their respective owners.</p><p>Intel and Intel Xeon are trademarks or registered trademarks of Intel Corporation. All SPARC trademarks are used under license and are trademarks or registered trademarks of SPARC International, Inc. AMD, Opteron, the AMD logo, and the AMD Opteron logo are trademarks or registered trademarks of Advanced Micro Devices. UNIX is a registered trademark of The Open Group.</p><p>This software or hardware and documentation may provide access to or information about content, products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and expressly disclaim all warranties of any kind with respect to third-party content, products, and services unless otherwise set forth in an applicable agreement between you and Oracle. Oracle Corporation and its affiliates will not be responsible for any loss, costs, or damages incurred due to your access to or use of third-party content, products, or services, except as set forth in an applicable agreement between you and Oracle.</p><p>This documentation is NOT distributed under a GPL license. Use of this documentation is subject to the following terms:</p><p>You may create a printed copy of this documentation solely for your own personal use. Conversion to other formats is allowed as long as the actual content is not altered or edited in any way. You shall not publish or distribute this documentation in any form or on any media, except if you distribute the documentation in a manner similar to how Oracle disseminates it (that is, electronically for download on a Web site with the software) or on a CD-ROM or similar medium, provided however that the documentation is disseminated together with the software on the same medium. Any other use, such as any dissemination of printed copies or use of this documentation, in whole or in part, in another publication, requires the prior written consent from an authorized representative of Oracle. Oracle and/or its affiliates reserve any and all rights to this documentation not expressly granted above.</p><p>Documentation Accessibility<br>For information about Oracle’s commitment to accessibility, visit the Oracle Accessibility Program website at <a href="http://www.oracle.com/pls/topic/lookup?ctx=acc&amp;id=docacc" target="_blank" rel="noopener">http://www.oracle.com/pls/topic/lookup?ctx=acc&amp;id=docacc</a>.</p><p>Access to Oracle Support<br>Oracle customers that have purchased support have access to electronic support through My Oracle Support. For information, visit <a href="http://www.oracle.com/pls/topic/lookup?ctx=acc&amp;id=info" target="_blank" rel="noopener">http://www.oracle.com/pls/topic/lookup?ctx=acc&amp;id=info</a> or visit <a href="http://www.oracle.com/pls/topic/lookup?ctx=acc&amp;id=trs" target="_blank" rel="noopener">http://www.oracle.com/pls/topic/lookup?ctx=acc&amp;id=trs</a> if you are hearing impaired.</p><p>  [37ml#repo-qg-apt-replace-direct</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;标签： MySQL APT Repository&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;【来自：&lt;a href=&quot;https://dev.mysql.com/doc/mysql-apt-repo-quick-guide/en/】&quot; target=&quot;_blank&quot; rel=&quot;noopene
      
    
    </summary>
    
      <category term="树莓派" scheme="http://www.lifayu.com/categories/%E6%A0%91%E8%8E%93%E6%B4%BE/"/>
    
    
      <category term="树莓派" scheme="http://www.lifayu.com/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/"/>
    
      <category term="MySQL" scheme="http://www.lifayu.com/tags/MySQL/"/>
    
  </entry>
  
</feed>
